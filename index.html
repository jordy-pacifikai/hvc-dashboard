<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HVC Command Center</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%233b82f6'/%3E%3Cstop offset='100%25' stop-color='%238b5cf6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23g)'/%3E%3Ctext x='50' y='68' font-family='Arial Black' font-size='50' font-weight='900' fill='white' text-anchor='middle'%3EH%3C/text%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        dark: {
                            900: '#0a0a0f',
                            800: '#12121a',
                            700: '#1a1a24',
                            600: '#24242f',
                            500: '#2e2e3a',
                        },
                        accent: {
                            blue: '#3b82f6',
                            purple: '#8b5cf6',
                            cyan: '#06b6d4',
                            green: '#10b981',
                            orange: '#f59e0b',
                            red: '#ef4444',
                            pink: '#ec4899',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #1a1a24; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 3px; }
        .gradient-border { background: linear-gradient(135deg, #3b82f6, #8b5cf6, #06b6d4); padding: 1px; }
        .glass { background: rgba(26, 26, 36, 0.8); backdrop-filter: blur(10px); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(59, 130, 246, 0.1); }
        .pulse-dot { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .nav-item { transition: all 0.2s ease; }
        .nav-item:hover { background: rgba(59, 130, 246, 0.1); }
        .nav-item.active { background: rgba(59, 130, 246, 0.2); border-left: 3px solid #3b82f6; }
        .status-badge { font-size: 0.65rem; padding: 2px 8px; border-radius: 9999px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .calendar-day { transition: all 0.2s ease; }
        .calendar-day:hover { background: rgba(59, 130, 246, 0.2); }
        .calendar-day.has-content { position: relative; }
        .calendar-day.has-content::after { content: ''; position: absolute; bottom: 4px; left: 50%; transform: translateX(-50%); width: 4px; height: 4px; background: #3b82f6; border-radius: 50%; }
        .funnel-step { position: relative; }
        .funnel-step::before { content: ''; position: absolute; left: 20px; top: 40px; bottom: -20px; width: 2px; background: linear-gradient(to bottom, #3b82f6, transparent); }
        .funnel-step:last-child::before { display: none; }
        .priority-critical { border-left: 3px solid #ef4444; }
        .priority-haute { border-left: 3px solid #f59e0b; }
        .priority-moyenne { border-left: 3px solid #3b82f6; }
        .priority-basse { border-left: 3px solid #6b7280; }
        .loading { opacity: 0.5; pointer-events: none; }
        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .toast { animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body class="bg-dark-900 text-white min-h-screen">
    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Config Modal -->
    <div id="config-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
        <div class="bg-dark-800 rounded-2xl p-8 max-w-md w-full mx-4 border border-dark-600">
            <h2 class="text-xl font-bold mb-6">Configuration Airtable</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">API Key (Personal Access Token)</label>
                    <input type="password" id="config-api-key" class="w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-sm" placeholder="AIRTABLE_KEY_PLACEHOLDER..">
                    <p class="text-xs text-gray-500 mt-1">Obtenir sur airtable.com/create/tokens</p>
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Base ID</label>
                    <input type="text" id="config-base-id" class="w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-sm" value="appW1YCDJVOMmLicc" placeholder="appXXXXXXX">
                </div>
                <div class="pt-4 flex gap-3">
                    <button onclick="saveConfig()" class="flex-1 bg-blue-500 hover:bg-blue-600 py-3 rounded-lg font-medium transition">
                        Sauvegarder
                    </button>
                    <button onclick="closeConfigModal()" class="px-6 py-3 bg-dark-600 hover:bg-dark-500 rounded-lg transition">
                        Annuler
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Planner Modal -->
    <div id="content-planner-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
        <div class="bg-dark-800 rounded-2xl p-8 max-w-2xl w-full mx-4 border border-dark-600 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold flex items-center gap-3">
                    <svg class="w-6 h-6 text-accent-purple" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    Content Planner
                </h2>
                <button onclick="closeContentPlannerModal()" class="p-2 hover:bg-dark-700 rounded-lg transition">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Date Range Selection -->
            <div class="mb-6">
                <label class="block text-sm text-gray-400 mb-3">Periode du rapport</label>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs text-gray-500 mb-2">Date de debut</label>
                        <input type="date" id="planner-start-date" class="w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-white focus:border-accent-purple focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-2">Date de fin</label>
                        <input type="date" id="planner-end-date" class="w-full bg-dark-700 border border-dark-600 rounded-lg px-4 py-3 text-white focus:border-accent-purple focus:outline-none transition">
                    </div>
                </div>
                <p id="date-range-info" class="text-xs text-gray-500 mt-2"></p>
            </div>

            <!-- Brand Selection -->
            <div class="mb-6">
                <label class="block text-sm text-gray-400 mb-3">Choisir la marque</label>
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="selectBrand('jordy')" id="brand-jordy" class="brand-btn p-4 rounded-xl border-2 border-dark-600 hover:border-accent-cyan transition flex flex-col items-center gap-2">
                        <div class="w-14 h-14 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center font-bold text-xl">JB</div>
                        <span class="font-medium">Jordy Banks</span>
                        <span class="text-xs text-gray-500">Personal Brand</span>
                    </button>
                    <button onclick="selectBrand('hvc')" id="brand-hvc" class="brand-btn p-4 rounded-xl border-2 border-dark-600 hover:border-accent-purple transition flex flex-col items-center gap-2">
                        <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center font-bold text-xl">HVC</div>
                        <span class="font-medium">High Value Capital</span>
                        <span class="text-xs text-gray-500">Trading Business</span>
                    </button>
                </div>
            </div>

            <!-- Content Types -->
            <div id="content-options" class="mb-6 hidden">
                <label class="block text-sm text-gray-400 mb-3">Types de contenu inclus</label>
                <div class="grid grid-cols-2 gap-3">
                    <label class="flex items-center gap-3 p-3 bg-dark-700 rounded-lg cursor-pointer hover:bg-dark-600 transition">
                        <input type="checkbox" checked class="content-type w-4 h-4 accent-accent-blue" value="instagram">
                        <span class="text-sm">Instagram Posts</span>
                    </label>
                    <label class="flex items-center gap-3 p-3 bg-dark-700 rounded-lg cursor-pointer hover:bg-dark-600 transition">
                        <input type="checkbox" checked class="content-type w-4 h-4 accent-accent-blue" value="stories">
                        <span class="text-sm">Stories</span>
                    </label>
                    <label class="flex items-center gap-3 p-3 bg-dark-700 rounded-lg cursor-pointer hover:bg-dark-600 transition">
                        <input type="checkbox" checked class="content-type w-4 h-4 accent-accent-blue" value="reels">
                        <span class="text-sm">Reels / Videos</span>
                    </label>
                    <label class="flex items-center gap-3 p-3 bg-dark-700 rounded-lg cursor-pointer hover:bg-dark-600 transition">
                        <input type="checkbox" class="content-type w-4 h-4 accent-accent-blue" value="newsletter">
                        <span class="text-sm">Newsletter</span>
                    </label>
                </div>
            </div>

            <!-- Generate Buttons -->
            <div id="generate-buttons" class="hidden">
                <div class="flex gap-3">
                    <button onclick="generateContentPlan('html')" class="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                        Ouvrir en HTML
                    </button>
                    <button onclick="generateContentPlan('pdf')" class="flex-1 bg-accent-green hover:bg-green-600 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Telecharger PDF
                    </button>
                </div>
            </div>

            <!-- Preview will be inserted here -->
            <div id="content-preview" class="mt-6 hidden">
                <div class="border-t border-dark-600 pt-6">
                    <h3 class="text-sm font-medium text-gray-400 mb-4">Apercu du planning</h3>
                    <div id="preview-content" class="space-y-3 max-h-60 overflow-y-auto"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-dark-800 border-r border-dark-600 z-40 flex flex-col">
        <!-- Logo -->
        <div class="p-6 border-b border-dark-600">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center font-bold text-lg">
                    HVC
                </div>
                <div>
                    <h1 class="font-bold text-lg">Command Center</h1>
                    <p class="text-xs text-gray-500">Scanner IA Trading</p>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
            <a href="#" onclick="showSection('dashboard')" class="nav-item active flex items-center gap-3 px-4 py-3 rounded-lg text-sm" data-section="dashboard">
                <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                </svg>
                Dashboard
            </a>
            <a href="#" onclick="showSection('calendar')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="calendar">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                Calendrier
            </a>
            <a href="#" onclick="showSection('content')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="content">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                </svg>
                Planning Contenu
            </a>
            <a href="#" onclick="showSection('funnel')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="funnel">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                </svg>
                Funnel IA
            </a>
            <a href="#" onclick="showSection('crm')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="crm">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                </svg>
                CRM Leads
            </a>
            <a href="#" onclick="showSection('scanner')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="scanner">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                Scanner Stats
            </a>

            <!-- Separator - Analytics -->
            <div class="my-3 border-t border-dark-600"></div>
            <p class="px-4 text-xs text-gray-600 uppercase tracking-wider mb-2">Analytics</p>

            <a href="#" onclick="showSection('newsletter')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="newsletter">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
                Newsletter
            </a>
            <a href="#" onclick="showSection('kpis')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="kpis">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                Content KPIs
            </a>
            <a href="#" onclick="showSection('revenue')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="revenue">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Revenue
            </a>
            <a href="#" onclick="showSection('signals')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="signals">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                </svg>
                Signals Log
            </a>

            <!-- Separator - Community -->
            <div class="my-3 border-t border-dark-600"></div>
            <p class="px-4 text-xs text-gray-600 uppercase tracking-wider mb-2">Community</p>

            <a href="#" onclick="showSection('testimonials')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="testimonials">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                </svg>
                Temoignages
            </a>
            <a href="#" onclick="showSection('members')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="members">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                Membres
            </a>
            <a href="#" onclick="showSection('onboarding')" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400" data-section="onboarding">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                </svg>
                Onboarding
            </a>

            <!-- Separator -->
            <div class="my-3 border-t border-dark-600"></div>
            <p class="px-4 text-xs text-gray-600 uppercase tracking-wider mb-2">Rapports</p>

            <a href="../affiliation-broker/ai-trading/audusd_analysis/hvc_premium_report.html" target="_blank" class="nav-item flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                Backtest Report
                <svg class="w-3 h-3 ml-auto text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                </svg>
            </a>

            <!-- Separator -->
            <div class="my-3 border-t border-dark-600"></div>
            <p class="px-4 text-xs text-gray-600 uppercase tracking-wider mb-2">Outils</p>

            <button onclick="openContentPlannerModal()" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm text-gray-400 hover:bg-dark-700 transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                Content Planner
                <span class="ml-auto text-xs bg-accent-purple/20 text-accent-purple px-2 py-0.5 rounded-full">15j</span>
            </button>
        </nav>

        <!-- Scanner Status -->
        <div class="p-4 border-t border-dark-600">
            <div class="bg-dark-700 rounded-xl p-4">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-xs text-gray-500 uppercase tracking-wider">Scanner V8</span>
                    <span id="scanner-status-badge" class="flex items-center gap-1.5">
                        <span id="scanner-status-dot" class="w-2 h-2 bg-gray-500 rounded-full"></span>
                        <span id="scanner-status-text" class="text-xs text-gray-400">...</span>
                    </span>
                </div>

                <!-- Mode actuel -->
                <div id="scanner-mode" class="mb-3">
                    <div class="flex items-center gap-2 mb-1">
                        <span id="scanner-mode-icon" class="text-lg">⏸️</span>
                        <span id="scanner-mode-text" class="text-sm font-medium text-gray-300">Calcul...</span>
                    </div>
                    <div id="scanner-mode-detail" class="text-xs text-gray-500">Chargement...</div>
                </div>

                <!-- Stats -->
                <div class="flex items-center justify-between pt-2 border-t border-dark-600">
                    <div>
                        <div class="text-lg font-bold text-white" id="scanner-pips">+0.0</div>
                        <div class="text-xs text-gray-500">Total Pips</div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-white" id="scanner-winrate">--%</div>
                        <div class="text-xs text-gray-500">Win Rate</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Button -->
        <div class="p-4 border-t border-dark-600">
            <button onclick="openConfigModal()" class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-dark-700 hover:bg-dark-600 rounded-lg text-sm text-gray-400 transition">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                Configuration
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 min-h-screen">
        <!-- Header -->
        <header class="sticky top-0 z-30 bg-dark-900/80 backdrop-blur-xl border-b border-dark-700">
            <div class="flex items-center justify-between px-8 py-4">
                <div>
                    <h2 class="text-xl font-semibold" id="page-title">Dashboard</h2>
                    <p class="text-sm text-gray-500" id="page-subtitle">Vue d'ensemble de ton business</p>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="refreshData()" class="p-2 hover:bg-dark-700 rounded-lg transition" title="Rafraichir les donnees">
                        <svg id="refresh-icon" class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                    </button>
                    <div class="text-right">
                        <div class="text-sm font-medium" id="current-time">--:--</div>
                        <div class="text-xs text-gray-500">Tahiti (UTC-10)</div>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center font-bold">
                        JB
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="section-dashboard" class="p-8">
            <!-- Stats Cards -->
            <div class="grid grid-cols-4 gap-6 mb-8">
                <div class="bg-dark-800 rounded-2xl p-6 card-hover border border-dark-600">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center">
                            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <span class="text-xs text-green-400 bg-green-400/10 px-2 py-1 rounded-full">Cette semaine</span>
                    </div>
                    <div class="text-3xl font-bold mb-1" id="stat-reels">-</div>
                    <div class="text-sm text-gray-500">Reels Planifies</div>
                </div>

                <div class="bg-dark-800 rounded-2xl p-6 card-hover border border-dark-600">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center">
                            <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </div>
                        <span class="text-xs text-blue-400 bg-blue-400/10 px-2 py-1 rounded-full">Total</span>
                    </div>
                    <div class="text-3xl font-bold mb-1" id="stat-leads">-</div>
                    <div class="text-sm text-gray-500">Leads CRM</div>
                </div>

                <div class="bg-dark-800 rounded-2xl p-6 card-hover border border-dark-600">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 rounded-xl bg-orange-500/20 flex items-center justify-center">
                            <svg class="w-6 h-6 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                            </svg>
                        </div>
                        <span class="text-xs text-orange-400 bg-orange-400/10 px-2 py-1 rounded-full">En cours</span>
                    </div>
                    <div class="text-3xl font-bold mb-1" id="stat-tasks">-</div>
                    <div class="text-sm text-gray-500">Taches Funnel</div>
                </div>

                <div class="bg-dark-800 rounded-2xl p-6 card-hover border border-dark-600">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center">
                            <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <span class="text-xs text-green-400 bg-green-400/10 px-2 py-1 rounded-full">PAMM</span>
                    </div>
                    <div class="text-3xl font-bold mb-1" id="stat-capital">$0</div>
                    <div class="text-sm text-gray-500">Capital Gere</div>
                </div>
            </div>

            <!-- Two Columns -->
            <div class="grid grid-cols-3 gap-6">
                <!-- Left: Weekly Calendar Preview -->
                <div class="col-span-2 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                    <div class="p-6 border-b border-dark-600 flex items-center justify-between">
                        <h3 class="font-semibold">Cette Semaine</h3>
                        <button onclick="showSection('calendar')" class="text-sm text-blue-400 hover:text-blue-300">Voir calendrier</button>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-5 gap-4" id="week-preview">
                            <div class="text-center text-gray-500 py-8">Chargement...</div>
                        </div>
                    </div>
                </div>

                <!-- Right: Priority Tasks -->
                <div class="bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                    <div class="p-6 border-b border-dark-600 flex items-center justify-between">
                        <h3 class="font-semibold">Taches Prioritaires</h3>
                        <span class="status-badge bg-red-500/20 text-red-400">Critiques</span>
                    </div>
                    <div class="p-4 space-y-3 max-h-[300px] overflow-y-auto" id="priority-tasks">
                        <div class="text-center text-gray-500 py-4">Chargement...</div>
                    </div>
                </div>
            </div>

            <!-- Funnel Progress -->
            <div class="mt-6 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                <div class="p-6 border-b border-dark-600">
                    <h3 class="font-semibold">Progression Funnel</h3>
                </div>
                <div class="p-6" id="funnel-progress">
                    <div class="text-center text-gray-500 py-4">Chargement...</div>
                </div>
            </div>

            <!-- Content KPIs Dashboard -->
            <div class="mt-6 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                <div class="p-6 border-b border-dark-600 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-pink-500 to-purple-600 flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-semibold">Content KPIs</h3>
                            <p class="text-xs text-gray-500">Performance des 7 derniers jours</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="filterKPIs('all')" class="kpi-filter-btn px-3 py-1.5 text-sm rounded-lg bg-purple-500/20 text-purple-400" data-filter="all">Tous</button>
                        <button onclick="filterKPIs('Jordy Banks')" class="kpi-filter-btn px-3 py-1.5 text-sm rounded-lg hover:bg-dark-600 text-gray-400" data-filter="Jordy Banks">JB</button>
                        <button onclick="filterKPIs('High Value Capital')" class="kpi-filter-btn px-3 py-1.5 text-sm rounded-lg hover:bg-dark-600 text-gray-400" data-filter="High Value Capital">HVC</button>
                    </div>
                </div>

                <!-- KPI Summary Cards -->
                <div class="p-6 grid grid-cols-5 gap-4 border-b border-dark-600">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-pink-400" id="kpi-total-reach">-</div>
                        <div class="text-xs text-gray-500">Reach Total</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-400" id="kpi-total-engagement">-</div>
                        <div class="text-xs text-gray-500">Engagement</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-400" id="kpi-avg-rate">-</div>
                        <div class="text-xs text-gray-500">Taux Moyen</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-yellow-400" id="kpi-best-type">-</div>
                        <div class="text-xs text-gray-500">Meilleur Type</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-purple-400" id="kpi-best-theme">-</div>
                        <div class="text-xs text-gray-500">Meilleur Theme</div>
                    </div>
                </div>

                <!-- Top Performers List -->
                <div class="p-6">
                    <h4 class="text-sm font-medium text-gray-400 mb-4">Top Performers (Score > 70)</h4>
                    <div class="space-y-3" id="kpi-top-performers">
                        <div class="flex items-center justify-between p-3 bg-dark-700 rounded-xl">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center text-green-400 text-sm font-bold">1</div>
                                <div>
                                    <div class="text-sm font-medium">Chargement...</div>
                                    <div class="text-xs text-gray-500">-</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-bold text-green-400">-</div>
                                <div class="text-xs text-gray-500">Score</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Theme Performance Chart -->
                <div class="p-6 border-t border-dark-600">
                    <h4 class="text-sm font-medium text-gray-400 mb-4">Performance par Theme</h4>
                    <div class="grid grid-cols-2 gap-4" id="kpi-theme-chart">
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-400">Morning_Routine</span>
                                <span class="text-xs text-gray-500">-</span>
                            </div>
                            <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                                <div class="h-full bg-gradient-to-r from-pink-500 to-purple-500 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="section-calendar" class="p-8 hidden">
            <div class="bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                <div class="p-6 border-b border-dark-600 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <button onclick="changeMonth(-1)" class="p-2 hover:bg-dark-600 rounded-lg transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                        </button>
                        <h3 class="font-semibold text-lg" id="calendar-month">Janvier 2026</h3>
                        <button onclick="changeMonth(1)" class="p-2 hover:bg-dark-600 rounded-lg transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="filterCalendar('all')" class="calendar-filter-btn px-3 py-1.5 text-sm rounded-lg bg-blue-500/20 text-blue-400" data-filter="all">Tous</button>
                        <button onclick="filterCalendar('Jordy Banks')" class="calendar-filter-btn px-3 py-1.5 text-sm rounded-lg hover:bg-dark-600 text-gray-400" data-filter="Jordy Banks">Jordy Banks</button>
                        <button onclick="filterCalendar('High Value Capital')" class="calendar-filter-btn px-3 py-1.5 text-sm rounded-lg hover:bg-dark-600 text-gray-400" data-filter="High Value Capital">HVC</button>
                    </div>
                </div>

                <!-- Calendar Grid -->
                <div class="p-6">
                    <!-- Days Header -->
                    <div class="grid grid-cols-7 gap-2 mb-4">
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Lun</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Mar</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Mer</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Jeu</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Ven</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Sam</div>
                        <div class="text-center text-sm text-gray-500 font-medium py-2">Dim</div>
                    </div>

                    <!-- Calendar Days -->
                    <div class="grid grid-cols-7 gap-2" id="calendar-grid">
                        <div class="col-span-7 text-center text-gray-500 py-8">Chargement...</div>
                    </div>
                </div>
            </div>

            <!-- Selected Day Content -->
            <div class="mt-6 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden" id="day-content">
                <div class="p-6 border-b border-dark-600">
                    <h3 class="font-semibold" id="selected-day-title">Selectionne un jour</h3>
                </div>
                <div class="p-6" id="selected-day-content">
                    <p class="text-gray-500 text-sm">Clique sur un jour pour voir le contenu planifie</p>
                </div>
            </div>
        </section>

        <!-- Content Planning Section -->
        <section id="section-content" class="p-8 hidden h-[calc(100vh-80px)] flex flex-col">
            <div class="flex gap-6 flex-1 min-h-0">
                <!-- Content List -->
                <div class="flex-1 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden flex flex-col">
                    <div class="p-6 border-b border-dark-600 flex items-center justify-between flex-shrink-0">
                        <h3 class="font-semibold">Planning Contenu</h3>
                        <div class="flex items-center gap-2">
                            <!-- Filtre Période -->
                            <select id="content-filter-period" onchange="renderContentList()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-1.5 text-sm">
                                <option value="all">Toutes les dates</option>
                                <option value="week">Cette semaine</option>
                                <option value="month">Ce mois</option>
                                <option value="past">Passés</option>
                            </select>
                            <select id="content-filter-compte" onchange="renderContentList()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-1.5 text-sm">
                                <option value="all">Tous les comptes</option>
                                <option value="Jordy Banks">Jordy Banks</option>
                                <option value="High Value Capital">High Value Capital</option>
                            </select>
                            <select id="content-filter-status" onchange="renderContentList()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-1.5 text-sm">
                                <option value="all">Tous les status</option>
                                <option value="Idée">Idée</option>
                                <option value="Script">Script</option>
                                <option value="En Production">En Production</option>
                                <option value="Prêt">Prêt</option>
                                <option value="Publié">Publié</option>
                            </select>
                        </div>
                    </div>
                    <div class="divide-y divide-dark-600 overflow-y-auto flex-1" id="content-list">
                        <div class="p-8 text-center text-gray-500">Chargement...</div>
                    </div>
                </div>

                <!-- Content Detail -->
                <div class="w-96 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden flex flex-col">
                    <div class="p-6 border-b border-dark-600 flex-shrink-0">
                        <h3 class="font-semibold">Detail du Contenu</h3>
                    </div>
                    <div class="p-6 overflow-y-auto flex-1" id="content-detail">
                        <p class="text-gray-500 text-sm">Selectionne un contenu pour voir les details</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Funnel Section -->
        <section id="section-funnel" class="p-8 hidden">
            <div class="flex gap-6">
                <!-- Funnel Steps -->
                <div class="w-80 space-y-4">
                    <div class="funnel-step">
                        <button onclick="filterFunnel('1. Awareness')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-blue-500/50 transition" data-step="1. Awareness">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 font-bold">1</div>
                                <div>
                                    <div class="font-medium">Awareness</div>
                                    <div class="text-xs text-gray-500">Faire decouvrir le scanner</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div class="funnel-step">
                        <button onclick="filterFunnel('2. Interest')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-cyan-500/50 transition" data-step="2. Interest">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-400 font-bold">2</div>
                                <div>
                                    <div class="font-medium">Interest</div>
                                    <div class="text-xs text-gray-500">Capturer l'attention</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div class="funnel-step">
                        <button onclick="filterFunnel('3. Consideration')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-teal-500/50 transition" data-step="3. Consideration">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-teal-500/20 flex items-center justify-center text-teal-400 font-bold">3</div>
                                <div>
                                    <div class="font-medium">Consideration</div>
                                    <div class="text-xs text-gray-500">Eduquer et convaincre</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div class="funnel-step">
                        <button onclick="filterFunnel('4. Conversion')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-green-500/50 transition" data-step="4. Conversion">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 font-bold">4</div>
                                <div>
                                    <div class="font-medium">Conversion</div>
                                    <div class="text-xs text-gray-500">Obtenir le depot</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div class="funnel-step">
                        <button onclick="filterFunnel('5. Onboarding')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-yellow-500/50 transition" data-step="5. Onboarding">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center text-yellow-400 font-bold">5</div>
                                <div>
                                    <div class="font-medium">Onboarding</div>
                                    <div class="text-xs text-gray-500">Accompagner le nouveau</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div class="funnel-step">
                        <button onclick="filterFunnel('6. Retention')" class="funnel-step-btn w-full text-left bg-dark-800 rounded-xl p-4 border border-dark-600 hover:border-orange-500/50 transition" data-step="6. Retention">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400 font-bold">6</div>
                                <div>
                                    <div class="font-medium">Retention</div>
                                    <div class="text-xs text-gray-500">Fideliser</div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <button onclick="filterFunnel('all')" class="w-full text-center py-2 text-sm text-gray-400 hover:text-white transition">
                        Voir toutes les taches
                    </button>
                </div>

                <!-- Tasks List -->
                <div class="flex-1 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                    <div class="p-6 border-b border-dark-600 flex items-center justify-between">
                        <h3 class="font-semibold" id="funnel-title">Toutes les taches</h3>
                        <div class="flex items-center gap-2">
                            <select id="funnel-filter-status" onchange="renderFunnelTasks()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-1.5 text-sm">
                                <option value="all">Tous les status</option>
                                <option value="À faire">À faire</option>
                                <option value="En cours">En cours</option>
                                <option value="En attente">En attente</option>
                                <option value="Terminé">Terminé</option>
                            </select>
                        </div>
                    </div>
                    <div class="divide-y divide-dark-600 max-h-[600px] overflow-y-auto" id="funnel-tasks">
                        <div class="p-8 text-center text-gray-500">Chargement...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CRM Section -->
        <section id="section-crm" class="p-8 hidden">
            <div class="flex gap-6">
                <!-- Pipeline -->
                <div class="flex-1">
                    <div class="flex gap-4 overflow-x-auto pb-4" id="crm-pipeline">
                        <!-- Nouveau -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-gray-500"></div>
                                    <span class="font-medium text-sm">Nouveau</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-nouveau">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-nouveau"></div>
                        </div>

                        <!-- Contacté -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                    <span class="font-medium text-sm">Contacté</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-contacte">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-contacte"></div>
                        </div>

                        <!-- Intéressé -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-cyan-500"></div>
                                    <span class="font-medium text-sm">Intéressé</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-interesse">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-interesse"></div>
                        </div>

                        <!-- Qualifié -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                                    <span class="font-medium text-sm">Qualifié</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-qualifie">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-qualifie"></div>
                        </div>

                        <!-- En attente dépôt -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-orange-500"></div>
                                    <span class="font-medium text-sm">En attente dépôt</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-attente">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-attente"></div>
                        </div>

                        <!-- Investisseur actif -->
                        <div class="min-w-[280px] bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                            <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                    <span class="font-medium text-sm">Investisseur actif</span>
                                </div>
                                <span class="text-xs text-gray-500" id="count-actif">0</span>
                            </div>
                            <div class="p-3 space-y-3 min-h-[200px]" id="pipeline-actif"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Lead Form -->
            <div class="mt-6 bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                <div class="p-6 border-b border-dark-600">
                    <h3 class="font-semibold">Ajouter un Lead</h3>
                </div>
                <div class="p-6">
                    <form id="add-lead-form" class="grid grid-cols-4 gap-4">
                        <input type="text" placeholder="Nom" class="bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm" id="lead-nom" required>
                        <input type="email" placeholder="Email" class="bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm" id="lead-email">
                        <input type="text" placeholder="@instagram" class="bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm" id="lead-instagram">
                        <select class="bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm" id="lead-source">
                            <option value="Instagram DM">Instagram DM</option>
                            <option value="TikTok">TikTok</option>
                            <option value="Landing Page">Landing Page</option>
                            <option value="Referral">Referral</option>
                        </select>
                        <div class="col-span-4 flex justify-end">
                            <button type="submit" class="bg-blue-500 hover:bg-blue-600 px-6 py-2 rounded-lg text-sm font-medium transition">
                                Ajouter Lead
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Scanner Stats Section -->
        <section id="section-scanner" class="p-8 hidden">
            <div class="grid grid-cols-4 gap-6 mb-8">
                <div class="bg-dark-800 rounded-2xl p-6 border border-dark-600">
                    <div class="text-sm text-gray-500 mb-2">Total Trades</div>
                    <div class="text-3xl font-bold" id="scanner-total-trades">0</div>
                </div>
                <div class="bg-dark-800 rounded-2xl p-6 border border-dark-600">
                    <div class="text-sm text-gray-500 mb-2">Win Rate</div>
                    <div class="text-3xl font-bold text-green-400" id="scanner-winrate">0%</div>
                </div>
                <div class="bg-dark-800 rounded-2xl p-6 border border-dark-600">
                    <div class="text-sm text-gray-500 mb-2">Total Pips</div>
                    <div class="text-3xl font-bold" id="scanner-total-pips">+0.0</div>
                </div>
                <div class="bg-dark-800 rounded-2xl p-6 border border-dark-600">
                    <div class="text-sm text-gray-500 mb-2">Status</div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 bg-green-500 rounded-full pulse-dot"></span>
                        <span class="text-lg font-medium text-green-400">Running</span>
                    </div>
                </div>
            </div>

            <!-- Trade History -->
            <div class="bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden">
                <div class="p-6 border-b border-dark-600">
                    <h3 class="font-semibold">Historique des Trades</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-dark-700">
                            <tr>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Date</th>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Direction</th>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Entry</th>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Exit</th>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Resultat</th>
                                <th class="text-left px-6 py-3 text-xs text-gray-500 font-medium uppercase">Pips</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-dark-600" id="trade-history">
                            <tr>
                                <td colspan="6" class="px-6 py-8 text-center text-gray-500">
                                    En attente des premiers trades...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Newsletter Analytics Section -->
        <section id="section-newsletter" class="p-8 hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-2">Newsletter Analytics</h2>
                <p class="text-gray-400">Performance des emails Brevo - Sequence Onboarding & Newsletters</p>
            </div>
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-3xl font-bold text-blue-400" id="newsletter-total-sent">-</div>
                    <div class="text-sm text-gray-400">Emails envoyes</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-3xl font-bold text-green-400" id="newsletter-open-rate">-</div>
                    <div class="text-sm text-gray-400">Taux ouverture</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-3xl font-bold text-cyan-400" id="newsletter-click-rate">-</div>
                    <div class="text-sm text-gray-400">Taux de clic</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-3xl font-bold text-red-400" id="newsletter-unsub-rate">-</div>
                    <div class="text-sm text-gray-400">Desabonnements</div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-6">
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Derniers Envois</h3>
                    </div>
                    <div class="divide-y divide-dark-600" id="newsletter-recent-list">
                        <div class="p-4 text-gray-500 text-center">Chargement...</div>
                    </div>
                </div>
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Sequence Onboarding</h3>
                    </div>
                    <div class="p-4" id="newsletter-onboarding-stats">
                        <div class="text-gray-500 text-center">Chargement...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Content KPIs Section -->
        <section id="section-kpis" class="p-8 hidden">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-2">Content KPIs</h2>
                    <p class="text-gray-400">Performance des posts Instagram & Facebook</p>
                </div>
                <select id="kpi-filter-compte" onchange="renderKPIs()" class="bg-dark-700 border border-dark-600 rounded-lg px-4 py-2">
                    <option value="all">Tous les comptes</option>
                    <option value="Jordy Banks">Jordy Banks</option>
                    <option value="High Value Capital">High Value Capital</option>
                </select>
            </div>
            <div class="grid grid-cols-5 gap-4 mb-6">
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-pink-400" id="kpi-total-likes">-</div>
                    <div class="text-xs text-gray-400">Total Likes</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-blue-400" id="kpi-total-comments">-</div>
                    <div class="text-xs text-gray-400">Commentaires</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-green-400" id="kpi-total-shares">-</div>
                    <div class="text-xs text-gray-400">Partages</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-purple-400" id="kpi-total-reach">-</div>
                    <div class="text-xs text-gray-400">Reach Total</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-yellow-400" id="kpi-avg-engagement">-</div>
                    <div class="text-xs text-gray-400">Engagement Moy.</div>
                </div>
            </div>
            <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                <div class="p-4 border-b border-dark-600 flex items-center justify-between">
                    <h3 class="font-semibold">Posts par Performance</h3>
                    <span class="text-xs text-gray-500">Trie par engagement</span>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-dark-700 text-xs text-gray-400 uppercase">
                            <tr>
                                <th class="px-4 py-3 text-left">Post</th>
                                <th class="px-4 py-3 text-center">Compte</th>
                                <th class="px-4 py-3 text-center">Likes</th>
                                <th class="px-4 py-3 text-center">Comments</th>
                                <th class="px-4 py-3 text-center">Shares</th>
                                <th class="px-4 py-3 text-center">Reach</th>
                                <th class="px-4 py-3 text-center">Engagement</th>
                                <th class="px-4 py-3 text-center">Score</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-dark-600" id="kpi-posts-table">
                            <tr><td colspan="8" class="p-4 text-center text-gray-500">Chargement...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Revenue Tracker Section -->
        <section id="section-revenue" class="p-8 hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-2">Revenue Tracker</h2>
                <p class="text-gray-400">Suivi des revenus - Affiliations, Formations, Copytrade</p>
            </div>
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-gradient-to-br from-green-500/20 to-green-600/10 rounded-xl p-6 border border-green-500/30">
                    <div class="text-sm text-green-400 mb-1">CA Total</div>
                    <div class="text-3xl font-bold" id="revenue-total">-</div>
                    <div class="text-xs text-gray-400 mt-2">Ce mois</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-sm text-blue-400 mb-1">Affiliations</div>
                    <div class="text-2xl font-bold" id="revenue-affiliations">-</div>
                    <div class="text-xs text-gray-400 mt-2">Broker commissions</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-sm text-purple-400 mb-1">Formations</div>
                    <div class="text-2xl font-bold" id="revenue-formations">-</div>
                    <div class="text-xs text-gray-400 mt-2">Ventes directes</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-6 border border-dark-600">
                    <div class="text-sm text-cyan-400 mb-1">Copytrade</div>
                    <div class="text-2xl font-bold" id="revenue-copytrade">-</div>
                    <div class="text-xs text-gray-400 mt-2">Performance fees</div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-6">
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Historique des Transactions</h3>
                    </div>
                    <div class="divide-y divide-dark-600 max-h-96 overflow-y-auto" id="revenue-transactions">
                        <div class="p-4 text-gray-500 text-center">Configure le suivi des revenus</div>
                    </div>
                </div>
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Objectifs Mensuels</h3>
                    </div>
                    <div class="p-4 space-y-4" id="revenue-goals">
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Objectif Affiliations</span>
                                <span class="text-blue-400">1 500 € / 3 000 €</span>
                            </div>
                            <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 rounded-full" style="width: 50%"></div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Objectif Formations</span>
                                <span class="text-purple-400">800 € / 2 000 €</span>
                            </div>
                            <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                                <div class="h-full bg-purple-500 rounded-full" style="width: 40%"></div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span>Objectif Copytrade</span>
                                <span class="text-cyan-400">200 € / 1 000 €</span>
                            </div>
                            <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                                <div class="h-full bg-cyan-500 rounded-full" style="width: 20%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Trading Signals Log Section -->
        <section id="section-signals" class="p-8 hidden">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-2">Trading Signals Log</h2>
                    <p class="text-gray-400">Historique des signaux MT5 envoyes aux membres</p>
                </div>
                <div class="flex items-center gap-2">
                    <select id="signals-filter-pair" onchange="renderSignals()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm">
                        <option value="all">Toutes les paires</option>
                        <option value="AUDUSD">AUDUSD</option>
                        <option value="EURUSD">EURUSD</option>
                        <option value="GBPUSD">GBPUSD</option>
                    </select>
                    <select id="signals-filter-result" onchange="renderSignals()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm">
                        <option value="all">Tous resultats</option>
                        <option value="win">Gagnants</option>
                        <option value="loss">Perdants</option>
                        <option value="pending">En cours</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold" id="signals-total">-</div>
                    <div class="text-xs text-gray-400">Signaux envoyes</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-green-500/30 text-center">
                    <div class="text-2xl font-bold text-green-400" id="signals-wins">-</div>
                    <div class="text-xs text-gray-400">Gagnants</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-red-500/30 text-center">
                    <div class="text-2xl font-bold text-red-400" id="signals-losses">-</div>
                    <div class="text-xs text-gray-400">Perdants</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-blue-500/30 text-center">
                    <div class="text-2xl font-bold text-blue-400" id="signals-winrate">-</div>
                    <div class="text-xs text-gray-400">Win Rate</div>
                </div>
            </div>
            <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-dark-700 text-xs text-gray-400 uppercase">
                            <tr>
                                <th class="px-4 py-3 text-left">Date</th>
                                <th class="px-4 py-3 text-left">Paire</th>
                                <th class="px-4 py-3 text-center">Direction</th>
                                <th class="px-4 py-3 text-center">Entry</th>
                                <th class="px-4 py-3 text-center">TP</th>
                                <th class="px-4 py-3 text-center">SL</th>
                                <th class="px-4 py-3 text-center">Resultat</th>
                                <th class="px-4 py-3 text-center">Pips</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-dark-600" id="signals-table">
                            <tr><td colspan="8" class="p-4 text-center text-gray-500">Chargement...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="section-testimonials" class="p-8 hidden">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-2">Temoignages</h2>
                    <p class="text-gray-400">Avis des membres High Value Capital</p>
                </div>
                <div class="flex items-center gap-2">
                    <select id="testimonials-filter-rating" onchange="renderTestimonials()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm">
                        <option value="all">Toutes les notes</option>
                        <option value="5">5 etoiles</option>
                        <option value="4">4 etoiles</option>
                    </select>
                    <button onclick="openTestimonialModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Ajouter
                    </button>
                </div>
            </div>
            <div class="grid grid-cols-3 gap-4 mb-6">
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-yellow-400" id="testimonials-count">-</div>
                    <div class="text-xs text-gray-400">Total avis</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-green-400" id="testimonials-avg-rating">-</div>
                    <div class="text-xs text-gray-400">Note moyenne</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold text-blue-400" id="testimonials-published">-</div>
                    <div class="text-xs text-gray-400">Publies</div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-6" id="testimonials-grid">
                <div class="p-8 text-center text-gray-500">Chargement...</div>
            </div>
        </section>

        <!-- Members Section -->
        <section id="section-members" class="p-8 hidden">
            <div class="mb-6 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-2">Membres Actifs</h2>
                    <p class="text-gray-400">Liste des membres Heartbeat HVC</p>
                </div>
                <div class="flex items-center gap-2">
                    <select id="members-filter-status" onchange="renderMembers()" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm">
                        <option value="all">Tous les membres</option>
                        <option value="active">Actifs</option>
                        <option value="inactive">Inactifs</option>
                        <option value="new">Nouveaux (7j)</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-dark-800 rounded-xl p-4 border border-dark-600 text-center">
                    <div class="text-2xl font-bold" id="members-total">-</div>
                    <div class="text-xs text-gray-400">Total membres</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-green-500/30 text-center">
                    <div class="text-2xl font-bold text-green-400" id="members-active">-</div>
                    <div class="text-xs text-gray-400">Actifs (30j)</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-yellow-500/30 text-center">
                    <div class="text-2xl font-bold text-yellow-400" id="members-new">-</div>
                    <div class="text-xs text-gray-400">Nouveaux (7j)</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-red-500/30 text-center">
                    <div class="text-2xl font-bold text-red-400" id="members-churn">-</div>
                    <div class="text-xs text-gray-400">Churn (30j)</div>
                </div>
            </div>
            <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                <div class="overflow-x-auto max-h-[500px]">
                    <table class="w-full">
                        <thead class="bg-dark-700 text-xs text-gray-400 uppercase sticky top-0">
                            <tr>
                                <th class="px-4 py-3 text-left">Membre</th>
                                <th class="px-4 py-3 text-left">Email</th>
                                <th class="px-4 py-3 text-center">Inscription</th>
                                <th class="px-4 py-3 text-center">Derniere activite</th>
                                <th class="px-4 py-3 text-center">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-dark-600" id="members-table">
                            <tr><td colspan="5" class="p-4 text-center text-gray-500">Chargement...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Onboarding Tracker Section -->
        <section id="section-onboarding" class="p-8 hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-2">Onboarding Tracker</h2>
                <p class="text-gray-400">Suivi de la sequence email des nouveaux membres</p>
            </div>
            <div class="grid grid-cols-7 gap-3 mb-6">
                <div class="bg-dark-800 rounded-xl p-4 border border-blue-500/30 text-center">
                    <div class="text-xl font-bold text-blue-400" id="onboard-step-1">-</div>
                    <div class="text-xs text-gray-400">Email 1</div>
                    <div class="text-[10px] text-gray-500">Bienvenue</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-cyan-500/30 text-center">
                    <div class="text-xl font-bold text-cyan-400" id="onboard-step-2">-</div>
                    <div class="text-xs text-gray-400">Email 2</div>
                    <div class="text-[10px] text-gray-500">J+1</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-teal-500/30 text-center">
                    <div class="text-xl font-bold text-teal-400" id="onboard-step-3">-</div>
                    <div class="text-xs text-gray-400">Email 3</div>
                    <div class="text-[10px] text-gray-500">J+3</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-green-500/30 text-center">
                    <div class="text-xl font-bold text-green-400" id="onboard-step-4">-</div>
                    <div class="text-xs text-gray-400">Email 4</div>
                    <div class="text-[10px] text-gray-500">J+5</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-yellow-500/30 text-center">
                    <div class="text-xl font-bold text-yellow-400" id="onboard-step-5">-</div>
                    <div class="text-xs text-gray-400">Email 5</div>
                    <div class="text-[10px] text-gray-500">J+7</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-orange-500/30 text-center">
                    <div class="text-xl font-bold text-orange-400" id="onboard-step-6">-</div>
                    <div class="text-xs text-gray-400">Email 6</div>
                    <div class="text-[10px] text-gray-500">J+10</div>
                </div>
                <div class="bg-dark-800 rounded-xl p-4 border border-purple-500/30 text-center">
                    <div class="text-xl font-bold text-purple-400" id="onboard-step-7">-</div>
                    <div class="text-xs text-gray-400">Email 7</div>
                    <div class="text-[10px] text-gray-500">J+14</div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-6">
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Membres en Onboarding</h3>
                    </div>
                    <div class="divide-y divide-dark-600 max-h-96 overflow-y-auto" id="onboarding-members">
                        <div class="p-4 text-gray-500 text-center">Chargement...</div>
                    </div>
                </div>
                <div class="bg-dark-800 rounded-xl border border-dark-600 overflow-hidden">
                    <div class="p-4 border-b border-dark-600">
                        <h3 class="font-semibold">Conversion Funnel</h3>
                    </div>
                    <div class="p-4" id="onboarding-funnel">
                        <div class="space-y-3">
                            <div class="flex items-center gap-3">
                                <div class="w-full bg-dark-600 rounded-full h-6 overflow-hidden">
                                    <div class="h-full bg-blue-500 flex items-center justify-end pr-2" style="width: 100%">
                                        <span class="text-xs font-medium">100% - Inscrit</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-full bg-dark-600 rounded-full h-6 overflow-hidden">
                                    <div class="h-full bg-cyan-500 flex items-center justify-end pr-2" style="width: 75%">
                                        <span class="text-xs font-medium">75% - Email ouvert</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-full bg-dark-600 rounded-full h-6 overflow-hidden">
                                    <div class="h-full bg-green-500 flex items-center justify-end pr-2" style="width: 45%">
                                        <span class="text-xs font-medium">45% - Lien clique</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-full bg-dark-600 rounded-full h-6 overflow-hidden">
                                    <div class="h-full bg-yellow-500 flex items-center justify-end pr-2" style="width: 25%">
                                        <span class="text-xs font-medium">25% - Compte cree</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-full bg-dark-600 rounded-full h-6 overflow-hidden">
                                    <div class="h-full bg-purple-500 flex items-center justify-end pr-2" style="width: 12%">
                                        <span class="text-xs font-medium">12% - Depot</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ILIA Chatbot Widget -->
    <div id="ilia-chatbot" class="fixed bottom-6 right-6 z-50">
        <div id="ilia-chat-window" class="hidden mb-4 w-96 bg-dark-800 rounded-2xl border border-dark-600 shadow-2xl overflow-hidden">
            <div class="p-4 bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                        <span class="text-xl">🤖</span>
                    </div>
                    <div>
                        <h4 class="font-semibold">ILIA</h4>
                        <p class="text-xs text-white/70">Assistant HVC</p>
                    </div>
                </div>
                <button onclick="toggleIliaChat()" class="text-white/70 hover:text-white">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="ilia-messages" class="h-80 overflow-y-auto p-4 space-y-3">
                <div class="flex gap-2">
                    <div class="w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0">
                        <span>🤖</span>
                    </div>
                    <div class="bg-dark-700 rounded-lg rounded-tl-none p-3 max-w-[80%]">
                        <p class="text-sm">Salut Jordy! Je suis ILIA, ton assistant HVC. Comment puis-je t'aider?</p>
                    </div>
                </div>
            </div>
            <div class="p-4 border-t border-dark-600">
                <div class="flex gap-2">
                    <input type="text" id="ilia-input" placeholder="Ecris ton message..." class="flex-1 bg-dark-700 border border-dark-600 rounded-lg px-4 py-2 text-sm" onkeypress="if(event.key==='Enter')sendIliaMessage()">
                    <button onclick="sendIliaMessage()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <button onclick="toggleIliaChat()" class="w-14 h-14 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-transform">
            <span class="text-2xl">🤖</span>
        </button>
    </div>

    <script>
        // =====================
        // CONFIGURATION
        // =====================

        const CONFIG = {
            baseId: 'appW1YCDJVOMmLicc',
            tables: {
                content: 'tbl1j7PjKpUeiYaP6',
                funnel: 'tblcqxxRNzInsApPc',
                leads: 'tblPmw0tse5j5Sp9a',
                testimonials: 'tblLd5ceQbg6v8EyH',
                onboarding: 'tblj3Zl2pArjMrblR',
                kpis: 'tblz4uWokbwVEtbY0',
                trades: 'tbltofezo6xGlblrK',
                revenue: 'tblwJdgD6sMyreQfR',
                members: 'tblmRFtU0C4tOwBfW',
                newsletter: 'tbllP13TKKxyjruSI'
            }
        };

        // Scanner status
        let scannerStatus = 'unknown';

        // Store data
        let contentData = [];
        let funnelTasks = [];
        let leads = [];
        let trades = [];
        let calendarFilter = 'all';
        let currentFunnelFilter = 'all';

        // =====================
        // TIMEZONE UTILITIES (Tahiti = UTC-10)
        // =====================

        // Convert UTC date string to Tahiti local date string (YYYY-MM-DD)
        function utcToTahitiDate(utcDateStr) {
            if (!utcDateStr) return '';
            const utcDate = new Date(utcDateStr);
            // Tahiti is UTC-10, so subtract 10 hours from UTC
            const tahitiDate = new Date(utcDate.getTime() - (10 * 60 * 60 * 1000));
            return tahitiDate.toISOString().split('T')[0];
        }

        // =====================
        // AIRTABLE API
        // =====================

        function getApiKey() {
            return localStorage.getItem('airtable_api_key') || '';
        }

        function setApiKey(key) {
            localStorage.setItem('airtable_api_key', key);
        }

        function getBaseId() {
            return localStorage.getItem('airtable_base_id') || CONFIG.baseId;
        }

        function setBaseId(id) {
            localStorage.setItem('airtable_base_id', id);
        }

        async function airtableFetch(tableId, options = {}) {
            const apiKey = getApiKey();
            if (!apiKey) {
                showToast('Configure ton API Key Airtable', 'error');
                openConfigModal();
                return null;
            }

            const baseId = getBaseId();
            let url = `https://api.airtable.com/v0/${baseId}/${tableId}`;

            if (options.params) {
                const params = new URLSearchParams(options.params);
                url += '?' + params.toString();
            }

            try {
                const response = await fetch(url, {
                    method: options.method || 'GET',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: options.body ? JSON.stringify(options.body) : undefined
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'Erreur API Airtable');
                }

                return await response.json();
            } catch (error) {
                console.error('Airtable error:', error);
                showToast(error.message, 'error');
                return null;
            }
        }

        async function createRecord(tableId, fields) {
            return await airtableFetch(tableId, {
                method: 'POST',
                body: { fields }
            });
        }

        async function updateRecord(tableId, recordId, fields) {
            const apiKey = getApiKey();
            const baseId = getBaseId();

            try {
                const response = await fetch(`https://api.airtable.com/v0/${baseId}/${tableId}/${recordId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fields })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'Erreur mise a jour');
                }

                return await response.json();
            } catch (error) {
                console.error('Update error:', error);
                showToast(error.message, 'error');
                return null;
            }
        }

        // =====================
        // DATA LOADING
        // =====================

        async function loadAllData() {
            const refreshIcon = document.getElementById('refresh-icon');
            refreshIcon.classList.add('spinner');

            try {
                await Promise.all([
                    loadContentData(),
                    loadFunnelData(),
                    loadLeadsData(),
                    loadTradesData()
                ]);

                renderAll();
                showToast('Donnees chargees', 'success');
            } catch (error) {
                showToast('Erreur de chargement', 'error');
            } finally {
                refreshIcon.classList.remove('spinner');
            }
        }

        async function loadContentData() {
            const result = await airtableFetch(CONFIG.tables.content);

            if (result && result.records) {
                contentData = result.records.map(r => {
                    const utcDate = r.fields['Date Publication'] || '';
                    return {
                        id: r.id,
                        titre: r.fields['Titre'] || '',
                        compte: r.fields['Compte'] || '',
                        format: r.fields['Format'] || 'Reel',
                        date: utcDate,
                        dateTahiti: utcToTahitiDate(utcDate), // Date locale Tahiti (YYYY-MM-DD)
                        status: r.fields['Status'] || 'Idée',
                        categorie: r.fields['Catégorie'] || '',
                        hook: r.fields['Hook'] || '',
                        script: r.fields['Script/Texte'] || '',
                        cta: r.fields['CTA'] || '',
                        notes: r.fields['Notes'] || ''
                    };
                });
                // Tri par date côté client
                contentData.sort((a, b) => new Date(a.date) - new Date(b.date));
            }
        }

        async function loadFunnelData() {
            const result = await airtableFetch(CONFIG.tables.funnel);

            if (result && result.records) {
                funnelTasks = result.records.map(r => ({
                    id: r.id,
                    tache: r.fields['Tâche'] || '',
                    etape: r.fields['Étape Funnel'] || '',
                    type: r.fields['Type'] || '',
                    priorite: r.fields['Priorité'] || 'Moyenne',
                    status: r.fields['Status'] || 'À faire',
                    deadline: r.fields['Deadline'] || '',
                    details: r.fields['Détails'] || '',
                    lien: r.fields['Lien'] || '',
                    notes: r.fields['Notes'] || ''
                }));
                // Tri par deadline côté client
                funnelTasks.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));
            }
        }

        async function loadLeadsData() {
            const result = await airtableFetch(CONFIG.tables.leads);

            if (result && result.records) {
                leads = result.records.map(r => ({
                    id: r.id,
                    nom: r.fields['Nom'] || '',
                    email: r.fields['Email'] || '',
                    telephone: r.fields['Téléphone'] || '',
                    instagram: r.fields['Instagram'] || '',
                    source: r.fields['Source'] || '',
                    status: r.fields['Status'] || 'Nouveau',
                    montantPrevu: r.fields['Montant Prévu'] || 0,
                    montantDepose: r.fields['Montant Déposé'] || 0,
                    dateContact: r.fields['Date Premier Contact'] || '',
                    notes: r.fields['Notes'] || ''
                }));
            }
        }

        async function loadTradesData() {
            const result = await airtableFetch(CONFIG.tables.trades);

            if (result && result.records) {
                trades = result.records.map(r => ({
                    id: r.id,
                    fields: r.fields, // Garder les fields bruts pour le scanner status
                    tradeId: r.fields['Trade ID'] || '',
                    symbol: r.fields['Symbol'] || 'AUDUSD',
                    direction: r.fields['Direction'] || '',
                    entryPrice: r.fields['Entry Price'] || 0,
                    slPrice: r.fields['SL Price'] || 0,
                    tpPrice: r.fields['TP Price'] || 0,
                    closePrice: r.fields['Close Price'] || null,
                    pips: r.fields['Pips'] || 0,
                    result: r.fields['Result'] || 'Open',
                    entryTime: r.fields['Entry Time'] || '',
                    closeTime: r.fields['Close Time'] || '',
                    duration: r.fields['Duration (min)'] || 0,
                    rsi: r.fields['RSI'] || null,
                    wick: r.fields['Wick %'] || null,
                    htfTrend: r.fields['HTF Trend'] || '',
                    notes: r.fields['Notes'] || ''
                }));
                // Tri par date d'entree (plus recent en premier)
                trades.sort((a, b) => new Date(b.entryTime) - new Date(a.entryTime));

                // Mettre à jour le statut du scanner
                updateScannerStatus();
            }
        }

        function refreshData() {
            loadAllData();
        }

        // =====================
        // RENDER FUNCTIONS
        // =====================

        function renderAll() {
            updateStats();
            renderWeekPreview();
            renderPriorityTasks();
            renderFunnelProgress();
            renderCalendar();
            renderContentList();
            renderFunnelTasks();
            renderCRM();
            renderScanner();
        }

        function updateStats() {
            // Content stats - use Tahiti dates for comparison
            // Get current time in Tahiti (UTC-10)
            const nowUtc = new Date();
            const tahitiNow = new Date(nowUtc.getTime() - (10 * 60 * 60 * 1000));

            // Find Monday of current week in Tahiti
            const tahitiDay = tahitiNow.getUTCDay(); // 0=Sunday
            const mondayOffset = tahitiDay === 0 ? -6 : 1 - tahitiDay;
            const weekStart = new Date(tahitiNow);
            weekStart.setUTCDate(tahitiNow.getUTCDate() + mondayOffset);

            const weekEnd = new Date(weekStart);
            weekEnd.setUTCDate(weekStart.getUTCDate() + 6);

            // Format dates as YYYY-MM-DD
            const weekStartStr = `${weekStart.getUTCFullYear()}-${String(weekStart.getUTCMonth() + 1).padStart(2, '0')}-${String(weekStart.getUTCDate()).padStart(2, '0')}`;
            const weekEndStr = `${weekEnd.getUTCFullYear()}-${String(weekEnd.getUTCMonth() + 1).padStart(2, '0')}-${String(weekEnd.getUTCDate()).padStart(2, '0')}`;

            const weekContent = contentData.filter(c => {
                if (!c.dateTahiti) return false;
                return c.dateTahiti >= weekStartStr && c.dateTahiti <= weekEndStr;
            });
            document.getElementById('stat-reels').textContent = weekContent.length;

            // Leads stats
            document.getElementById('stat-leads').textContent = leads.length;

            // Funnel tasks
            const pendingTasks = funnelTasks.filter(t => t.status !== 'Terminé');
            document.getElementById('stat-tasks').textContent = pendingTasks.length;

            // Capital (from active investors)
            const capital = leads
                .filter(l => l.status === 'Investisseur actif')
                .reduce((sum, l) => sum + (l.montantDepose || 0), 0);
            document.getElementById('stat-capital').textContent = '$' + capital.toLocaleString();
        }

        function renderWeekPreview() {
            const container = document.getElementById('week-preview');
            const days = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven'];

            // Get current week dates in TAHITI timezone
            // Create date in Tahiti by using UTC and adjusting
            const nowUtc = new Date();
            // Get Tahiti time by subtracting 10 hours from UTC
            const tahitiNow = new Date(nowUtc.getTime() - (10 * 60 * 60 * 1000));

            // Find Monday of current week in Tahiti
            const tahitiDay = tahitiNow.getUTCDay(); // 0=Sunday
            const mondayOffset = tahitiDay === 0 ? -6 : 1 - tahitiDay;
            const monday = new Date(tahitiNow);
            monday.setUTCDate(tahitiNow.getUTCDate() + mondayOffset);

            container.innerHTML = days.map((day, i) => {
                const date = new Date(monday);
                date.setUTCDate(monday.getUTCDate() + i);
                // Use UTC methods since we're already in Tahiti adjusted time
                const year = date.getUTCFullYear();
                const month = String(date.getUTCMonth() + 1).padStart(2, '0');
                const dayOfMonth = String(date.getUTCDate()).padStart(2, '0');
                const dateStr = `${year}-${month}-${dayOfMonth}`;
                const dayNum = date.getUTCDate();

                const dayContent = contentData.filter(c => c.dateTahiti === dateStr);

                return `
                    <div class="bg-dark-700 rounded-xl p-4">
                        <div class="text-xs text-gray-500 mb-1">${day}</div>
                        <div class="text-lg font-semibold mb-3">${dayNum}</div>
                        <div class="space-y-2">
                            ${dayContent.length === 0 ? '<div class="text-xs text-gray-600">-</div>' : ''}
                            ${dayContent.slice(0, 3).map(c => `
                                <div class="text-xs p-2 rounded-lg ${c.compte === 'Jordy Banks' ? 'bg-blue-500/20 text-blue-400' : 'bg-purple-500/20 text-purple-400'} truncate">
                                    ${c.titre.substring(0, 20)}${c.titre.length > 20 ? '...' : ''}
                                </div>
                            `).join('')}
                            ${dayContent.length > 3 ? `<div class="text-xs text-gray-500">+${dayContent.length - 3}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPriorityTasks() {
            const container = document.getElementById('priority-tasks');
            const criticalTasks = funnelTasks
                .filter(t => t.priorite === 'Critique' && t.status !== 'Terminé')
                .slice(0, 5);

            if (criticalTasks.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 py-4">Aucune tache critique</div>';
                return;
            }

            container.innerHTML = criticalTasks.map(task => `
                <div class="p-3 bg-dark-700 rounded-lg priority-critical cursor-pointer hover:bg-dark-600 transition" onclick="showTaskDetail('${task.id}')">
                    <div class="font-medium text-sm mb-1">${task.tache}</div>
                    <div class="flex items-center gap-2 text-xs text-gray-500">
                        <span class="${new Date(task.deadline) < new Date() ? 'text-red-400' : ''}">${task.deadline}</span>
                        <span>-</span>
                        <span>${task.type}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderFunnelProgress() {
            const container = document.getElementById('funnel-progress');
            const stages = ['1. Awareness', '2. Interest', '3. Consideration', '4. Conversion', '5. Onboarding', '6. Retention'];
            const colors = ['blue', 'cyan', 'teal', 'green', 'yellow', 'orange'];

            const stageStats = stages.map((stage, i) => {
                const total = funnelTasks.filter(t => t.etape === stage).length;
                const done = funnelTasks.filter(t => t.etape === stage && t.status === 'Terminé').length;
                return { stage: stage.split('. ')[1], total, done, color: colors[i] };
            });

            container.innerHTML = `
                <div class="flex items-center gap-4">
                    ${stageStats.map(s => `
                        <div class="flex-1">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-400">${s.stage}</span>
                                <span class="text-sm font-medium">${s.done}/${s.total}</span>
                            </div>
                            <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                                <div class="h-full bg-gradient-to-r from-${s.color}-500 to-${s.color}-400 rounded-full transition-all duration-500" style="width: ${s.total > 0 ? (s.done / s.total * 100) : 0}%"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // =====================
        // CALENDAR
        // =====================

        // Initialize with Tahiti time (UTC-10)
        const _initNowUtc = new Date();
        const _initTahiti = new Date(_initNowUtc.getTime() - (10 * 60 * 60 * 1000));
        let currentMonth = _initTahiti.getUTCMonth();
        let currentYear = _initTahiti.getUTCFullYear();

        function renderCalendar() {
            const container = document.getElementById('calendar-grid');
            const monthNames = ['Janvier', 'Fevrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Aout', 'Septembre', 'Octobre', 'Novembre', 'Decembre'];

            document.getElementById('calendar-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startDay = (firstDay.getDay() + 6) % 7;
            const daysInMonth = lastDay.getDate();

            let html = '';

            // Empty cells before first day
            for (let i = 0; i < startDay; i++) {
                html += '<div class="h-24"></div>';
            }

            // Days - use Tahiti time for "today" indicator
            const nowUtc = new Date();
            const tahitiToday = new Date(nowUtc.getTime() - (10 * 60 * 60 * 1000));
            const todayDay = tahitiToday.getUTCDate();
            const todayMonth = tahitiToday.getUTCMonth();
            const todayYear = tahitiToday.getUTCFullYear();

            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                let dayContent = contentData.filter(c => c.dateTahiti === dateStr);

                // Apply calendar filter
                if (calendarFilter !== 'all') {
                    dayContent = dayContent.filter(c => c.compte === calendarFilter);
                }

                const isToday = day === todayDay && currentMonth === todayMonth && currentYear === todayYear;

                html += `
                    <div onclick="selectDay('${dateStr}')" class="h-24 bg-dark-700 rounded-lg p-2 calendar-day cursor-pointer hover:bg-dark-600 transition ${isToday ? 'ring-2 ring-blue-500' : ''} ${dayContent.length ? 'has-content' : ''}">
                        <div class="text-sm font-medium ${isToday ? 'text-blue-400' : ''}">${day}</div>
                        <div class="mt-1 space-y-1">
                            ${dayContent.slice(0, 2).map(c => `
                                <div class="text-xs truncate px-1 py-0.5 rounded ${c.compte === 'Jordy Banks' ? 'bg-blue-500/20 text-blue-400' : 'bg-purple-500/20 text-purple-400'}">
                                    ${c.titre.substring(0, 12)}...
                                </div>
                            `).join('')}
                            ${dayContent.length > 2 ? `<div class="text-xs text-gray-500">+${dayContent.length - 2}</div>` : ''}
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }

        function filterCalendar(filter) {
            calendarFilter = filter;

            // Update button styles
            document.querySelectorAll('.calendar-filter-btn').forEach(btn => {
                if (btn.dataset.filter === filter) {
                    btn.classList.add('bg-blue-500/20', 'text-blue-400');
                    btn.classList.remove('text-gray-400');
                } else {
                    btn.classList.remove('bg-blue-500/20', 'text-blue-400');
                    btn.classList.add('text-gray-400');
                }
            });

            renderCalendar();
        }

        function selectDay(dateStr) {
            let dayContent = contentData.filter(c => c.dateTahiti === dateStr);
            if (calendarFilter !== 'all') {
                dayContent = dayContent.filter(c => c.compte === calendarFilter);
            }

            const date = new Date(dateStr);
            const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };

            document.getElementById('selected-day-title').textContent = date.toLocaleDateString('fr-FR', options);

            if (dayContent.length === 0) {
                document.getElementById('selected-day-content').innerHTML = '<p class="text-gray-500 text-sm">Aucun contenu planifie pour ce jour</p>';
                return;
            }

            document.getElementById('selected-day-content').innerHTML = dayContent.map(c => `
                <div class="p-4 bg-dark-700 rounded-xl mb-4 cursor-pointer hover:bg-dark-600 transition" onclick="showContentDetail('${c.id}'); showSection('content');">
                    <div class="flex items-center justify-between mb-3">
                        <span class="status-badge ${c.compte === 'Jordy Banks' ? 'bg-blue-500/20 text-blue-400' : 'bg-purple-500/20 text-purple-400'}">${c.compte}</span>
                        <span class="status-badge ${getStatusColor(c.status)}">${c.status}</span>
                    </div>
                    <h4 class="font-medium mb-2">${c.titre}</h4>
                    <p class="text-sm text-gray-400 mb-3">${c.hook}</p>
                    <div class="flex items-center gap-4 text-xs text-gray-500">
                        <span>${c.categorie}</span>
                        <span>-</span>
                        <span>CTA: ${c.cta}</span>
                    </div>
                </div>
            `).join('');
        }

        function getStatusColor(status) {
            const colors = {
                'Idée': 'bg-gray-500/20 text-gray-400',
                'Script': 'bg-yellow-500/20 text-yellow-400',
                'En Production': 'bg-blue-500/20 text-blue-400',
                'Prêt': 'bg-cyan-500/20 text-cyan-400',
                'Publié': 'bg-green-500/20 text-green-400'
            };
            return colors[status] || 'bg-gray-500/20 text-gray-400';
        }

        // =====================
        // CONTENT LIST
        // =====================

        function renderContentList() {
            const container = document.getElementById('content-list');
            const filterCompte = document.getElementById('content-filter-compte').value;
            const filterStatus = document.getElementById('content-filter-status').value;
            const filterPeriod = document.getElementById('content-filter-period').value;

            let filtered = contentData;
            if (filterCompte !== 'all') filtered = filtered.filter(c => c.compte === filterCompte);
            if (filterStatus !== 'all') filtered = filtered.filter(c => c.status === filterStatus);

            // Filtre par période
            if (filterPeriod !== 'all') {
                const now = new Date();
                const startOfWeek = new Date(now);
                startOfWeek.setDate(now.getDate() - now.getDay() + 1); // Lundi
                startOfWeek.setHours(0, 0, 0, 0);
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 6);
                endOfWeek.setHours(23, 59, 59, 999);

                const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59, 999);

                filtered = filtered.filter(c => {
                    if (!c.date) return filterPeriod === 'all';
                    const contentDate = new Date(c.date);

                    if (filterPeriod === 'week') {
                        return contentDate >= startOfWeek && contentDate <= endOfWeek;
                    } else if (filterPeriod === 'month') {
                        return contentDate >= startOfMonth && contentDate <= endOfMonth;
                    } else if (filterPeriod === 'past') {
                        return contentDate < now;
                    }
                    return true;
                });
            }

            if (filtered.length === 0) {
                container.innerHTML = '<div class="p-8 text-center text-gray-500">Aucun contenu trouve</div>';
                return;
            }

            container.innerHTML = filtered.map(c => `
                <div onclick="showContentDetail('${c.id}')" class="p-4 hover:bg-dark-700 cursor-pointer transition">
                    <div class="flex items-center justify-between mb-2">
                        <span class="status-badge ${c.compte === 'Jordy Banks' ? 'bg-blue-500/20 text-blue-400' : 'bg-purple-500/20 text-purple-400'}">${c.compte}</span>
                        <span class="text-xs text-gray-500">${c.dateTahiti || ''}</span>
                    </div>
                    <h4 class="font-medium text-sm mb-1">${c.titre}</h4>
                    <div class="flex items-center gap-2">
                        <span class="status-badge bg-dark-600 text-gray-400">${c.categorie}</span>
                        <span class="status-badge ${getStatusColor(c.status)}">${c.status}</span>
                    </div>
                </div>
            `).join('');
        }

        function showContentDetail(id) {
            const content = contentData.find(c => c.id === id);
            if (!content) return;

            document.getElementById('content-detail').innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="text-xs text-gray-500 uppercase">Titre</label>
                        <p class="font-medium">${content.titre}</p>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-gray-500 uppercase">Compte</label>
                            <p>${content.compte}</p>
                        </div>
                        <div>
                            <label class="text-xs text-gray-500 uppercase">Date (Tahiti)</label>
                            <p>${content.dateTahiti || ''}</p>
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-gray-500 uppercase">Hook</label>
                        <p class="text-sm text-gray-300">${content.hook}</p>
                    </div>
                    <div>
                        <label class="text-xs text-gray-500 uppercase">Script</label>
                        <pre class="text-sm text-gray-300 whitespace-pre-wrap bg-dark-700 p-3 rounded-lg mt-1">${content.script || 'Pas de script'}</pre>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-gray-500 uppercase">Categorie</label>
                            <p>${content.categorie}</p>
                        </div>
                        <div>
                            <label class="text-xs text-gray-500 uppercase">CTA</label>
                            <p>${content.cta}</p>
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-gray-500 uppercase">Status</label>
                        <select onchange="updateContentStatus('${content.id}', this.value)" class="w-full mt-1 bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm">
                            <option value="Idée" ${content.status === 'Idée' ? 'selected' : ''}>Idée</option>
                            <option value="Script" ${content.status === 'Script' ? 'selected' : ''}>Script</option>
                            <option value="En Production" ${content.status === 'En Production' ? 'selected' : ''}>En Production</option>
                            <option value="Prêt" ${content.status === 'Prêt' ? 'selected' : ''}>Prêt</option>
                            <option value="Publié" ${content.status === 'Publié' ? 'selected' : ''}>Publié</option>
                        </select>
                    </div>
                </div>
            `;
        }

        async function updateContentStatus(id, status) {
            const result = await updateRecord(CONFIG.tables.content, id, { 'Status': status });
            if (result) {
                const content = contentData.find(c => c.id === id);
                if (content) content.status = status;
                renderContentList();
                showToast('Status mis a jour', 'success');
            }
        }

        // =====================
        // FUNNEL TASKS
        // =====================

        function renderFunnelTasks() {
            const container = document.getElementById('funnel-tasks');
            const filterStatus = document.getElementById('funnel-filter-status').value;

            let filtered = funnelTasks;
            if (currentFunnelFilter !== 'all') filtered = filtered.filter(t => t.etape === currentFunnelFilter);
            if (filterStatus !== 'all') filtered = filtered.filter(t => t.status === filterStatus);

            // Sort by deadline
            filtered.sort((a, b) => new Date(a.deadline) - new Date(b.deadline));

            if (filtered.length === 0) {
                container.innerHTML = '<div class="p-8 text-center text-gray-500">Aucune tache trouvee</div>';
                return;
            }

            container.innerHTML = filtered.map(task => {
                const priorityClass = task.priorite === 'Critique' ? 'priority-critical' :
                                      task.priorite === 'Haute' ? 'priority-haute' :
                                      task.priorite === 'Moyenne' ? 'priority-moyenne' : 'priority-basse';
                const isOverdue = new Date(task.deadline) < new Date() && task.status !== 'Terminé';

                return `
                    <div class="p-4 hover:bg-dark-700 transition ${priorityClass} cursor-pointer" onclick="showTaskDetail('${task.id}')">
                        <div class="flex items-center justify-between mb-2">
                            <span class="status-badge bg-dark-600 text-gray-400">${task.etape}</span>
                            <div class="flex items-center gap-2">
                                <select onclick="event.stopPropagation()" onchange="updateTaskStatus('${task.id}', this.value)" class="bg-dark-600 border-none rounded px-2 py-1 text-xs">
                                    <option value="À faire" ${task.status === 'À faire' ? 'selected' : ''}>À faire</option>
                                    <option value="En cours" ${task.status === 'En cours' ? 'selected' : ''}>En cours</option>
                                    <option value="En attente" ${task.status === 'En attente' ? 'selected' : ''}>En attente</option>
                                    <option value="Terminé" ${task.status === 'Terminé' ? 'selected' : ''}>Terminé</option>
                                </select>
                            </div>
                        </div>
                        <h4 class="font-medium text-sm mb-2 ${task.status === 'Terminé' ? 'line-through text-gray-500' : ''}">${task.tache}</h4>
                        <div class="flex items-center gap-4 text-xs text-gray-500">
                            <span>${task.type}</span>
                            <span>-</span>
                            <span class="${isOverdue ? 'text-red-400 font-medium' : ''}">${task.deadline}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterFunnel(etape) {
            currentFunnelFilter = etape;
            document.getElementById('funnel-title').textContent = etape === 'all' ? 'Toutes les taches' : etape;

            // Update step button styles
            document.querySelectorAll('.funnel-step-btn').forEach(btn => {
                if (btn.dataset.step === etape) {
                    btn.classList.add('border-blue-500/50');
                } else {
                    btn.classList.remove('border-blue-500/50');
                }
            });

            renderFunnelTasks();
        }

        async function updateTaskStatus(id, status) {
            const result = await updateRecord(CONFIG.tables.funnel, id, { 'Status': status });
            if (result) {
                const task = funnelTasks.find(t => t.id === id);
                if (task) task.status = status;
                renderFunnelTasks();
                renderFunnelProgress();
                updateStats();
                showToast('Tache mise a jour', 'success');
            }
        }

        function showTaskDetail(id) {
            const task = funnelTasks.find(t => t.id === id);
            if (!task) return;

            // For now, just show in funnel section
            showSection('funnel');
            filterFunnel(task.etape);
        }

        // =====================
        // CRM
        // =====================

        function renderCRM() {
            const statuses = {
                'Nouveau': 'nouveau',
                'Contacté': 'contacte',
                'Intéressé': 'interesse',
                'Qualifié': 'qualifie',
                'En attente dépôt': 'attente',
                'Investisseur actif': 'actif'
            };

            Object.keys(statuses).forEach(status => {
                const container = document.getElementById(`pipeline-${statuses[status]}`);
                const statusLeads = leads.filter(l => l.status === status);

                document.getElementById(`count-${statuses[status]}`).textContent = statusLeads.length;

                if (statusLeads.length === 0) {
                    container.innerHTML = '<div class="text-center text-gray-500 text-xs py-4">Aucun lead</div>';
                } else {
                    container.innerHTML = statusLeads.map(lead => `
                        <div class="bg-dark-700 rounded-lg p-3 cursor-pointer hover:bg-dark-600 transition" onclick="showLeadDetail('${lead.id}')">
                            <div class="font-medium text-sm mb-1">${lead.nom}</div>
                            <div class="text-xs text-gray-500">${lead.instagram || lead.email || '-'}</div>
                            ${lead.montantPrevu ? `<div class="text-xs text-green-400 mt-2">$${lead.montantPrevu.toLocaleString()}</div>` : ''}
                        </div>
                    `).join('');
                }
            });
        }

        function showLeadDetail(id) {
            const lead = leads.find(l => l.id === id);
            if (!lead) return;
            // TODO: Show modal with lead details
            showToast(`Lead: ${lead.nom}`, 'info');
        }

        // =====================
        // SCANNER STATS
        // =====================

        function renderScanner() {
            // Calculer les stats
            const closedTrades = trades.filter(t => t.result !== 'Open');
            const winningTrades = trades.filter(t => t.result === 'TP');
            const totalTrades = closedTrades.length;
            const winRate = totalTrades > 0 ? (winningTrades.length / totalTrades * 100).toFixed(1) : 0;
            const totalPips = trades.reduce((sum, t) => sum + (t.pips || 0), 0);

            // Mettre a jour les stats cards
            document.getElementById('scanner-total-trades').textContent = totalTrades;
            document.getElementById('scanner-winrate').textContent = winRate + '%';

            const pipsDisplay = totalPips >= 0 ? '+' + totalPips.toFixed(1) : totalPips.toFixed(1);
            document.getElementById('scanner-total-pips').textContent = pipsDisplay;
            document.getElementById('scanner-total-pips').className = `text-3xl font-bold ${totalPips >= 0 ? 'text-green-400' : 'text-red-400'}`;

            // Mettre a jour le sidebar
            document.getElementById('scanner-pips').textContent = pipsDisplay;
            document.getElementById('scanner-pips').className = `text-2xl font-bold ${totalPips >= 0 ? 'text-green-400' : 'text-red-400'}`;

            // Rendre l'historique des trades
            renderTradeHistory();
        }

        function renderTradeHistory() {
            const container = document.getElementById('trade-history');

            if (trades.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-8 text-center text-gray-500">
                            En attente des premiers trades...
                        </td>
                    </tr>
                `;
                return;
            }

            container.innerHTML = trades.map(trade => {
                const directionClass = trade.direction === 'LONG' ? 'text-green-400' : 'text-red-400';
                const directionIcon = trade.direction === 'LONG' ? '&#x2191;' : '&#x2193;';

                let resultBadge = '';
                if (trade.result === 'TP') {
                    resultBadge = '<span class="status-badge bg-green-500/20 text-green-400">TP</span>';
                } else if (trade.result === 'SL') {
                    resultBadge = '<span class="status-badge bg-red-500/20 text-red-400">SL</span>';
                } else if (trade.result === 'Expired') {
                    resultBadge = '<span class="status-badge bg-yellow-500/20 text-yellow-400">Expired</span>';
                } else {
                    resultBadge = '<span class="status-badge bg-blue-500/20 text-blue-400">Open</span>';
                }

                const pipsClass = trade.pips >= 0 ? 'text-green-400' : 'text-red-400';
                const pipsDisplay = trade.result === 'Open' ? '-' : (trade.pips >= 0 ? '+' : '') + trade.pips.toFixed(1);

                const entryDate = trade.entryTime ? new Date(trade.entryTime).toLocaleString('fr-FR', {
                    day: '2-digit',
                    month: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : '-';

                return `
                    <tr class="hover:bg-dark-700 transition">
                        <td class="px-6 py-4 text-sm">${entryDate}</td>
                        <td class="px-6 py-4 text-sm ${directionClass} font-medium">${directionIcon} ${trade.direction}</td>
                        <td class="px-6 py-4 text-sm font-mono">${trade.entryPrice}</td>
                        <td class="px-6 py-4 text-sm font-mono">${trade.closePrice || '-'}</td>
                        <td class="px-6 py-4">${resultBadge}</td>
                        <td class="px-6 py-4 text-sm font-medium ${pipsClass}">${pipsDisplay}</td>
                    </tr>
                `;
            }).join('');
        }

        document.getElementById('add-lead-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            const fields = {
                'Nom': document.getElementById('lead-nom').value,
                'Email': document.getElementById('lead-email').value || undefined,
                'Instagram': document.getElementById('lead-instagram').value || undefined,
                'Source': document.getElementById('lead-source').value,
                'Status': 'Nouveau',
                'Date Premier Contact': new Date().toISOString().split('T')[0]
            };

            // Remove undefined fields
            Object.keys(fields).forEach(key => fields[key] === undefined && delete fields[key]);

            const result = await createRecord(CONFIG.tables.leads, fields);
            if (result) {
                leads.push({
                    id: result.id,
                    nom: fields['Nom'],
                    email: fields['Email'] || '',
                    instagram: fields['Instagram'] || '',
                    source: fields['Source'],
                    status: 'Nouveau',
                    dateContact: fields['Date Premier Contact']
                });
                renderCRM();
                updateStats();
                this.reset();
                showToast('Lead ajoute!', 'success');
            }
        });

        // =====================
        // NAVIGATION
        // =====================

        function showSection(section) {
            document.querySelectorAll('section[id^="section-"]').forEach(s => s.classList.add('hidden'));
            document.getElementById(`section-${section}`).classList.remove('hidden');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'text-white');
                item.classList.add('text-gray-400');
            });
            const activeNav = document.querySelector(`.nav-item[data-section="${section}"]`);
            if (activeNav) {
                activeNav.classList.add('active', 'text-white');
                activeNav.classList.remove('text-gray-400');
            }

            const titles = {
                dashboard: ['Dashboard', 'Vue d\'ensemble de ton business'],
                calendar: ['Calendrier', 'Planning de publication'],
                content: ['Planning Contenu', 'Gestion des Reels et Stories'],
                funnel: ['Funnel IA Trading', 'Construction du funnel investisseurs'],
                crm: ['CRM Leads', 'Gestion des prospects et investisseurs'],
                scanner: ['Scanner Stats', 'Performance du scanner IA'],
                newsletter: ['Newsletter Analytics', 'Performance des emails Brevo'],
                kpis: ['Content KPIs', 'Metriques de performance contenu'],
                revenue: ['Revenue Tracker', 'Suivi des revenus et abonnements'],
                signals: ['Signals Log', 'Historique des signaux trading'],
                testimonials: ['Temoignages', 'Gestion des temoignages clients'],
                members: ['Membres Actifs', 'Heartbeat de la communaute'],
                onboarding: ['Onboarding Tracker', 'Suivi des nouveaux membres']
            };
            document.getElementById('page-title').textContent = titles[section]?.[0] || section;
            document.getElementById('page-subtitle').textContent = titles[section]?.[1] || '';

            // Charger les donnees pour les nouvelles sections
            if (section === 'testimonials') loadTestimonials();
            if (section === 'signals') loadSignals();
            if (section === 'onboarding') loadOnboarding();
            if (section === 'revenue') loadRevenue();
            if (section === 'members') loadMembers();
            if (section === 'newsletter') loadNewsletter();
        }

        // =====================
        // CONFIG MODAL
        // =====================

        function openConfigModal() {
            document.getElementById('config-modal').classList.remove('hidden');
            document.getElementById('config-api-key').value = getApiKey();
            document.getElementById('config-base-id').value = getBaseId();
        }

        function closeConfigModal() {
            document.getElementById('config-modal').classList.add('hidden');
        }

        function saveConfig() {
            const apiKey = document.getElementById('config-api-key').value.trim();
            const baseId = document.getElementById('config-base-id').value.trim();

            if (!apiKey) {
                showToast('API Key requise', 'error');
                return;
            }

            setApiKey(apiKey);
            setBaseId(baseId || CONFIG.baseId);
            closeConfigModal();
            showToast('Configuration sauvegardee', 'success');
            loadAllData();
        }

        // =====================
        // CONTENT PLANNER MODAL
        // =====================

        let selectedBrand = null;

        function openContentPlannerModal() {
            document.getElementById('content-planner-modal').classList.remove('hidden');
            selectedBrand = null;
            document.querySelectorAll('.brand-btn').forEach(btn => {
                btn.classList.remove('border-accent-cyan', 'border-accent-purple', 'bg-dark-700');
                btn.classList.add('border-dark-600');
            });
            document.getElementById('content-options').classList.add('hidden');
            document.getElementById('generate-buttons').classList.add('hidden');
            document.getElementById('content-preview').classList.add('hidden');

            // Initialize default dates (today + 14 days = 15 days total)
            const today = new Date();
            const endDefault = new Date(today);
            endDefault.setDate(today.getDate() + 14);

            const formatDate = (d) => d.toISOString().split('T')[0];
            document.getElementById('planner-start-date').value = formatDate(today);
            document.getElementById('planner-end-date').value = formatDate(endDefault);
            document.getElementById('date-range-info').textContent = '15 jours de contenu';
        }

        function closeContentPlannerModal() {
            document.getElementById('content-planner-modal').classList.add('hidden');
        }

        function selectBrand(brand) {
            selectedBrand = brand;
            document.querySelectorAll('.brand-btn').forEach(btn => {
                btn.classList.remove('border-accent-cyan', 'border-accent-purple', 'bg-dark-700');
                btn.classList.add('border-dark-600');
            });

            const selectedBtn = document.getElementById(`brand-${brand}`);
            selectedBtn.classList.remove('border-dark-600');
            selectedBtn.classList.add(brand === 'jordy' ? 'border-accent-cyan' : 'border-accent-purple', 'bg-dark-700');

            document.getElementById('content-options').classList.remove('hidden');
            document.getElementById('generate-buttons').classList.remove('hidden');

            // Generate preview
            generatePreview();
        }

        function generatePreview() {
            const previewContainer = document.getElementById('preview-content');
            const days = [];

            const startDateInput = document.getElementById('planner-start-date').value;
            const endDateInput = document.getElementById('planner-end-date').value;

            if (!startDateInput || !endDateInput) {
                previewContainer.innerHTML = '<p class="text-gray-500 text-sm text-center py-4">Selectionne les dates pour voir l\'apercu</p>';
                document.getElementById('content-preview').classList.remove('hidden');
                return;
            }

            const startDate = new Date(startDateInput);
            const endDate = new Date(endDateInput);

            if (endDate < startDate) {
                previewContainer.innerHTML = '<p class="text-red-400 text-sm text-center py-4">La date de fin doit etre apres la date de debut</p>';
                document.getElementById('content-preview').classList.remove('hidden');
                return;
            }

            let currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                days.push(new Date(currentDate));
                currentDate.setDate(currentDate.getDate() + 1);
            }

            // Update info text
            const diffDays = days.length;
            document.getElementById('date-range-info').textContent = `${diffDays} jour${diffDays > 1 ? 's' : ''} de contenu`;

            const brandName = selectedBrand === 'jordy' ? 'Jordy Banks' : 'High Value Capital';
            const contentTypes = selectedBrand === 'jordy'
                ? ['Lifestyle', 'Behind the scenes', 'Motivation', 'Trading tip', 'Q&A', 'Resultats']
                : ['Analyse marche', 'Signal trading', 'Education', 'Resultats', 'Temoignage', 'Promo'];

            previewContainer.innerHTML = days.map((date, i) => {
                const dayName = date.toLocaleDateString('fr-FR', { weekday: 'short' });
                const dateStr = date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' });
                const content = contentTypes[i % contentTypes.length];
                const isWeekend = date.getDay() === 0 || date.getDay() === 6;

                return `
                    <div class="flex items-center gap-4 p-3 bg-dark-700 rounded-lg ${isWeekend ? 'opacity-60' : ''}">
                        <div class="w-16 text-center">
                            <div class="text-xs text-gray-500 uppercase">${dayName}</div>
                            <div class="font-bold">${dateStr}</div>
                        </div>
                        <div class="flex-1">
                            <div class="text-sm font-medium">${content}</div>
                            <div class="text-xs text-gray-500">Post + Story</div>
                        </div>
                        <div class="w-3 h-3 rounded-full ${selectedBrand === 'jordy' ? 'bg-accent-cyan' : 'bg-accent-purple'}"></div>
                    </div>
                `;
            }).join('');

            document.getElementById('content-preview').classList.remove('hidden');
        }

        function generateContentPlan(format) {
            if (!selectedBrand) {
                showToast('Selectionne une marque', 'error');
                return;
            }

            const contentTypes = [];
            document.querySelectorAll('.content-type:checked').forEach(cb => contentTypes.push(cb.value));

            if (contentTypes.length === 0) {
                showToast('Selectionne au moins un type de contenu', 'error');
                return;
            }

            const brandName = selectedBrand === 'jordy' ? 'Jordy Banks' : 'High Value Capital';
            const brandColor = selectedBrand === 'jordy' ? '#06b6d4' : '#8b5cf6';
            const brandGradient = selectedBrand === 'jordy'
                ? 'linear-gradient(135deg, #06b6d4, #3b82f6)'
                : 'linear-gradient(135deg, #3b82f6, #8b5cf6)';

            const startDateInput = document.getElementById('planner-start-date').value;
            const endDateInput = document.getElementById('planner-end-date').value;

            if (!startDateInput || !endDateInput) {
                showToast('Selectionne les dates de debut et fin', 'error');
                return;
            }

            const startDate = new Date(startDateInput);
            const endDate = new Date(endDateInput);

            if (endDate < startDate) {
                showToast('La date de fin doit etre apres la date de debut', 'error');
                return;
            }

            const days = [];
            let currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                days.push(new Date(currentDate));
                currentDate.setDate(currentDate.getDate() + 1);
            }

            // =====================
            // CONTENU DETAILLE JORDY BANKS
            // =====================
            const jordyThemes = [
                {
                    title: 'Morning Routine',
                    type: 'Reel',
                    duration: '30-60s',
                    hook: 'Ma routine a 5h du matin qui m\'a rendu rentable...',
                    script: `SCENE 1 (0-5s): Reveil naturel, vue sur l'ocean au lever du soleil
SCENE 2 (5-15s): Preparation cafe, vue sur la terrasse avec palmiers
SCENE 3 (15-25s): Check du telephone - notifications Telegram du scanner
SCENE 4 (25-40s): Installation au bureau, ouverture TradingView, analyse rapide
SCENE 5 (40-50s): Face cam parlant a la camera sur l'importance de la routine
SCENE 6 (50-60s): Retour sur l'ecran avec un trade en cours`,
                    instructions: `TOURNAGE:
- Commence AVANT le lever du soleil (golden hour)
- Utilise un trepied pour les plans fixes
- Filme en 9:16 (vertical) pour Reels/TikTok
- Plan large pour montrer le cadre de vie
- Gros plan sur le cafe, les ecrans, les mains
- Face cam avec bonne lumiere naturelle (face a la fenetre)

AUDIO:
- Musique lo-fi/chill en fond (volume 20%)
- Voix off ou sous-titres obligatoires
- Pas de bruit de fond (ventilo, etc.)

MONTAGE:
- Transitions smooth (cuts rapides)
- Ajouter sous-titres auto (CapCut)
- Texte overlay sur les moments cles`,
                    cta: 'Lien en bio pour decouvrir mon scanner IA',
                    ctaLevel: 'Soft',
                    equipment: ['Telephone (mode portrait)', 'Trepied', 'Ring light (optionnel)', 'Micro cravate (optionnel)'],
                    checklist: ['Verifier la meteo (golden hour)', 'Charger telephone', 'Nettoyer bureau/setup', 'Preparer le cafe', 'Ouvrir TradingView', 'Tester le son']
                },
                {
                    title: 'Behind The Screens',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories de 15s',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Video du setup avec vue Tahiti',
                            duration: '5-10s',
                            instruction: 'Plan large du bureau avec ecrans allumes et vue ocean en arriere-plan'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Screen record de l\'interface broker + execution trade',
                            duration: '10-15s',
                            instruction: 'Montrer les spreads, l\'execution rapide, un ordre qui passe'
                        },
                        {
                            act: 'CTA',
                            content: 'Face-cam: "Si tu veux les memes conditions, check le lien"',
                            duration: '5-10s',
                            instruction: 'Parler directement a la camera, authentique, pas de script lu'
                        }
                    ],
                    hook: 'Mon setup de trading a $0 de loyer...',
                    script: 'Story 1: [VIDEO] Setup complet avec vue\nStory 2: [SCREEN] Demo interface broker\nStory 3: [FACE CAM] CTA direct et authentique',
                    instructions: `STORY 1 - HOOK:
- Filme en mode selfie ou avec trepied
- Montre l'ensemble du setup (2-3 ecrans)
- La vue doit etre visible en arriere-plan
- Ajoute texte: "Mon bureau a Tahiti"

STORY 2 - CONTENT:
- Screen record de ton broker
- Montre un trade en cours ou une execution
- Highlight sur les spreads bas
- Zoom sur les elements importants

STORY 3 - CTA:
- Face cam, regarde la camera
- Lumiere naturelle de face
- Parle naturellement, pas de script
- Termine par le CTA vers lien bio`,
                    cta: 'Sticker Question "Tu trades sur quel broker?"',
                    ctaLevel: 'Ultra Soft',
                    equipment: ['Telephone', 'App screen record', 'Bonne lumiere'],
                    checklist: ['Ranger le bureau', 'Nettoyer les ecrans', 'Ouvrir broker + TradingView', 'Tester screen record', 'Verifier lumiere face cam']
                },
                {
                    title: 'Mindset Monday',
                    type: 'Post',
                    duration: 'Image + Caption',
                    hook: 'La difference entre un trader rentable et un perdant? Ce n\'est pas le setup...',
                    script: `CAPTION:
La difference entre un trader rentable et un perdant?

Ce n'est pas le setup.
Ce n'est pas le capital.
Ce n'est pas meme la strategie.

C'est la DISCIPLINE.

J'ai perdu 3 comptes avant de comprendre ca.

Aujourd'hui, je trade depuis Tahiti avec un scanner IA qui me donne les setups.

Mais meme avec le meilleur outil, sans discipline, tu perdras.

3 regles que j'applique chaque jour:
1. Je ne trade pas si je suis fatigue
2. Je respecte mon stop loss - TOUJOURS
3. Je prends mes profits quand le plan le dit

Simple? Oui.
Facile? Non.

Quelle est TA regle #1 en trading?
Commente ci-dessous 👇

---
#trading #forex #mindset #discipline #tahiti #lifestyle #trader`,
                    instructions: `VISUEL:
Option 1: Photo de toi en meditation/reflexion avec vue
Option 2: Template Canva avec citation en gros
Option 3: Carousel avec les 3 regles

TEMPLATE CANVA:
- Fond: Gradient sombre (#0f172a → #1e293b)
- Typo: Bebas Neue ou Montserrat Bold
- Couleur accent: Cyan (#06b6d4)
- Format: 1080x1350 (portrait Instagram)

PUBLICATION:
- Poster entre 7h-9h ou 18h-20h (heure locale audience)
- Repondre aux commentaires dans la 1ere heure`,
                    cta: 'Question dans la caption pour engagement',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Canva', 'Photo perso (optionnel)'],
                    checklist: ['Creer le visuel Canva', 'Ecrire caption finale', 'Verifier les hashtags', 'Programmer la publication', 'Preparer reponses aux commentaires']
                },
                {
                    title: 'Trade Breakdown',
                    type: 'Reel',
                    duration: '45-90s',
                    hook: 'Ce trade m\'a rapporte +47 pips pendant que je dormais...',
                    script: `INTRO (0-5s): "Ce trade m'a rapporte +47 pips pendant que je dormais"

PARTIE 1 - LE SIGNAL (5-20s):
"Hier soir, mon scanner IA m'a envoye cette notification sur Telegram"
[Montre screenshot notification]
"AUDUSD - Zone de demande H4 - Probabilite 78%"

PARTIE 2 - L'ANALYSE (20-45s):
[Screen record TradingView]
"Regardez le setup: on a un BOS clair ici"
[Dessine sur le chart]
"La zone de demande se situe la, avec le FVG juste au-dessus"
"Mon entry etait a 0.6542, stop sous la zone a 0.6520"
"Target 1 a 0.6589 pour un RR de 1:2"

PARTIE 3 - LE RESULTAT (45-60s):
"Ce matin au reveil..."
[Montre le trade cloture]
"+47 pips. Target atteint pendant la session asiatique"

OUTRO (60-75s):
"C'est ca l'avantage d'un scanner IA - tu dors, il travaille"
"Si tu veux voir comment je trade, lien en bio"`,
                    instructions: `TOURNAGE:
- Ecran TradingView propre (retire les indicateurs inutiles)
- Zoom sur les zones importantes
- Utilise l'outil dessin pour montrer BOS, zones, etc.
- Face cam pour intro/outro (regarder la camera)

SCREEN RECORD:
- Resolution max de ton ecran
- Cache les infos sensibles (solde compte, etc.)
- Curseur visible pour guider l'oeil
- Vitesse normale (pas accelere)

MONTAGE:
- Sous-titres OBLIGATOIRES (80% regardent sans son)
- Highlight les chiffres importants (+47 pips)
- Musique epic/motivante en fond (volume bas)
- Transitions clean entre les parties`,
                    cta: 'Swipe up "Meme conditions de trading" ou lien bio',
                    ctaLevel: 'Direct',
                    equipment: ['TradingView', 'Screen recorder', 'Notifications Telegram', 'Micro (pour voix off)'],
                    checklist: ['Identifier un trade gagnant recent', 'Preparer les screenshots', 'Ecrire le script detaille', 'Faire le screen record', 'Enregistrer la voix off', 'Monter avec sous-titres', 'Ajouter musique']
                },
                {
                    title: 'Q&A Session',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Screenshot d\'un DM avec question interessante',
                            duration: '5s',
                            instruction: 'Floute le nom, garde la question visible'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Face-cam reponse detaillee',
                            duration: '15-30s',
                            instruction: 'Repondre naturellement, donner de la vraie valeur'
                        },
                        {
                            act: 'CTA',
                            content: '"Pour ceux qui demandent mon broker..." + lien',
                            duration: '5s',
                            instruction: 'Texte sur fond avec lien'
                        }
                    ],
                    hook: 'Une question que je recois tout le temps...',
                    script: `STORY 1:
[Screenshot DM]
Texte overlay: "Question du jour"
Question: "Jordy, comment tu fais pour trader depuis Tahiti?"

STORY 2:
[Face cam - 20-30s]
"Alors cette question revient souvent...
En fait c'est simple: j'ai un scanner IA qui tourne 24/7.
Il analyse les marches, m'envoie des alertes sur Telegram.
Moi je check les setups, je valide ou pas, et j'execute.
Le plus dur c'etait de trouver un broker avec de bons spreads
qui accepte les clients francais.
Maintenant c'est automatise."

STORY 3:
[Texte sur fond]
"Pour ceux qui demandent mon broker...
👉 Lien en bio"
+ Sticker: "D'autres questions?"`,
                    instructions: `STORY 1:
- Screenshot propre (pas de notifs visibles)
- Floute le nom de la personne
- Question lisible et interessante

STORY 2:
- Face cam, lumiere naturelle
- Regarde la camera
- Parle naturellement, pas de script lu
- 20-30 secondes max

STORY 3:
- Fond gradient sombre
- Texte clair et lisible
- Sticker question pour engagement`,
                    cta: 'Naturel car repond a une vraie question + Sticker "D\'autres questions?"',
                    ctaLevel: 'Soft',
                    equipment: ['DMs recents', 'Telephone'],
                    checklist: ['Selectionner un DM interessant', 'Preparer la reponse (grandes lignes)', 'Filmer face cam', 'Creer le visuel Story 3']
                },
                {
                    title: 'Lifestyle Tahiti',
                    type: 'Post',
                    duration: 'Photo/Carousel',
                    hook: 'Bureau avec vue sur l\'ocean. Loyer: 0€.',
                    script: `CAPTION:
Bureau avec vue sur l'ocean.
Loyer: 0€.
Commute: 10 secondes.

Il y a 3 ans, je revais de ca.
Aujourd'hui c'est ma realite.

Le trading m'a donne cette liberte.
Pas le jour 1. Pas le mois 1.
Apres des annees de travail, de pertes, d'apprentissage.

Mais une fois que tu as un systeme qui fonctionne...
Tu peux travailler d'ou tu veux.

Mon "bureau" change chaque jour:
→ Terrasse face a l'ocean
→ Cafe au bord de la piscine
→ Hamac entre les palmiers

Le laptop et une connexion wifi.
C'est tout ce qu'il me faut.

Tu bosses d'ou aujourd'hui?

---
#digitalnomad #tahiti #trading #lifestyle #freedom #workfromanywhere #forex`,
                    instructions: `PHOTO:
- Golden hour (lever/coucher soleil)
- Montre le laptop/setup dans le cadre
- Vue ocean/nature en evidence
- Toi dans le cadre (de dos ou de profil = mystere)

CAROUSEL (5 slides):
1. Vue large du setup
2. Gros plan ecran avec trade
3. Vue panoramique
4. Toi en action (de dos, au telephone)
5. Sunset/moment lifestyle

QUALITE:
- Haute resolution
- Pas de filtres excessifs
- Couleurs naturelles`,
                    cta: 'Question engagement dans caption',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Telephone', 'Laptop visible', 'Cadre de vie'],
                    checklist: ['Reperer le spot photo', 'Attendre la bonne lumiere', 'Installer le setup dans le cadre', 'Prendre plusieurs angles', 'Selectionner les meilleures', 'Editer legerement', 'Ecrire caption']
                },
                {
                    title: 'Weekly Results',
                    type: 'Post',
                    duration: 'Image stats',
                    hook: 'Cette semaine avec le scanner IA: 5 trades, 4 wins, +67 pips',
                    script: `CAPTION:
📊 Recap Semaine #XX

5 trades executes
4 gagnants / 1 perdant
+67 pips net

Meilleur trade: AUDUSD +32 pips (BOS + Zone de demande)
Pire trade: EURUSD -12 pips (invalidation rapide)

Win rate: 80%
RR moyen: 1:2.3

Ce qui a bien fonctionne:
✅ Patience sur les entries
✅ Respect des zones du scanner
✅ Prise de profits partielle

Ce que j'ameliore:
🔄 Moins de trades pendant news
🔄 Meilleure gestion du FOMO

La semaine prochaine je focus sur AUDUSD et GBPUSD.
Le scanner a deja identifie 3 zones interessantes.

Tes resultats cette semaine? 📈

---
#trading #forex #weeklyrecap #results #pips #scanner`,
                    instructions: `VISUEL - Option 1 (Template Canva):
- Fond sombre avec accent cyan
- Stats en gros chiffres
- Layout clean et pro

VISUEL - Option 2 (Screenshot):
- Capture de ton journal de trading
- Blur sur les montants en $ si tu veux
- Highlight sur les pips

CONTENU:
- Toujours inclure wins ET losses (credibilite)
- Expliquer pourquoi ca a marche/pas marche
- Donner un plan pour la semaine suivante`,
                    cta: 'Slider "Combien de pips cette semaine?" + lien bio',
                    ctaLevel: 'Soft',
                    equipment: ['Journal de trading', 'Canva', 'Screenshots'],
                    checklist: ['Compiler les stats de la semaine', 'Identifier le meilleur/pire trade', 'Creer le visuel', 'Ecrire l\'analyse honnete', 'Ajouter plan semaine suivante']
                },
                {
                    title: 'Book/Podcast Review',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Photo/Video du livre avec texte "Ce livre a change ma vision"',
                            duration: '5s',
                            instruction: 'Tiens le livre, bonne lumiere, texte overlay'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Face cam: 2-3 lecons cles du livre',
                            duration: '15-20s',
                            instruction: 'Partage tes insights, pas un resume'
                        },
                        {
                            act: 'CTA',
                            content: 'Sticker Slider "Tu l\'as lu? Note /10"',
                            duration: '5s',
                            instruction: 'Engagement sans CTA broker'
                        }
                    ],
                    hook: 'Ce livre a change ma facon de trader...',
                    script: `STORY 1:
[Photo/Video avec le livre]
Texte: "Ce livre a change ma vision du trading"
Titre visible

STORY 2:
[Face cam]
"3 trucs que j'ai retenus de [TITRE]:

1. [Lecon 1 - en une phrase]
2. [Lecon 2 - en une phrase]
3. [Lecon 3 - en une phrase]

Si tu trades, tu DOIS le lire."

STORY 3:
[Photo livre]
Sticker Slider: "Tu l'as lu? Note sur 10"
Texte: "Dis-moi en DM si tu veux d'autres recos"`,
                    instructions: `LIVRES RECOMMANDES:
- Trading in the Zone (Mark Douglas)
- The Disciplined Trader (Mark Douglas)
- Market Wizards (Jack Schwager)
- Atomic Habits (James Clear)
- The Psychology of Money (Morgan Housel)

TOURNAGE:
- Lumiere naturelle sur le livre
- Montre que tu l'as vraiment lu (marque-pages, notes)
- Face cam authentique, pas de lecture`,
                    cta: 'Slider engagement, pas de CTA broker',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Le livre physique', 'Telephone'],
                    checklist: ['Choisir un livre pertinent', 'Noter 3 lecons cles', 'Filmer avec le livre', 'Preparer les insights']
                },
                {
                    title: 'Trading Setup Tour',
                    type: 'Reel',
                    duration: '45-60s',
                    hook: 'Mon setup de trading a Tahiti (cout total: moins que tu crois)',
                    script: `INTRO (0-5s):
"Mon setup de trading a Tahiti"
[Plan large du setup]

PARTIE 1 - LES ECRANS (5-15s):
"2 ecrans: un pour TradingView, un pour l'execution"
[Gros plan sur chaque ecran]
"Celui-la c'est un portable, celui-la un moniteur externe"

PARTIE 2 - LE MATERIEL (15-25s):
"MacBook Air M1 - largement suffisant pour trader"
"Moniteur 27 pouces - trouve sur le bon coin"
"Clavier et souris Logitech"
[Montre chaque element]

PARTIE 3 - LES APPS (25-40s):
"TradingView pour l'analyse"
"MetaTrader 5 pour l'execution"
"Telegram pour les alertes du scanner"
[Screen des apps]

PARTIE 4 - LE CADRE (40-50s):
"Et le plus important..."
[Tourne la camera vers la vue]
"...la vue qui n'a pas de prix"

OUTRO (50-60s):
"Cout total du setup materiel: moins de 2000€"
"Le reste c'est de la pratique et un bon systeme"`,
                    instructions: `TOURNAGE:
- Commence par plan large, puis zoome sur details
- Mouvements de camera fluides (gimbal si possible)
- Bonne lumiere sur le materiel
- Termine par la vue pour l'effet "wow"

MONTAGE:
- Texte overlay avec le nom de chaque element
- Prix optionnel (ajoute de la valeur)
- Musique chill/lo-fi
- Sous-titres obligatoires

TIPS:
- Range et nettoie tout avant
- Cache les cables (ou cable manage)
- Ecrans allumes avec contenu pertinent`,
                    cta: 'Lien en bio pour decouvrir le scanner',
                    ctaLevel: 'Soft',
                    equipment: ['Tout ton setup', 'Gimbal/trepied', 'Bonne lumiere'],
                    checklist: ['Nettoyer et ranger le setup', 'Cacher les cables', 'Allumer tous les ecrans', 'Preparer TradingView', 'Tester les mouvements de camera', 'Filmer plusieurs prises']
                },
                {
                    title: 'Erreur a Eviter',
                    type: 'Post',
                    duration: 'Carousel 5 slides',
                    hook: 'J\'ai perdu 3 comptes avant de comprendre cette erreur...',
                    script: `SLIDE 1 (HOOK):
"L'erreur #1 qui m'a coute 3 comptes"
[Background dramatique, texte gros]

SLIDE 2 (PROBLEME):
"Je deplacais mon stop loss"
"Chaque fois que le prix s'approchait..."
"Je le reculais 'pour lui laisser de l'espace'"

SLIDE 3 (CONSEQUENCE):
"Resultat:"
"→ Petites pertes devenues enormes"
"→ 3 comptes crames en 6 mois"
"→ Confiance a zero"

SLIDE 4 (SOLUTION):
"La regle que j'applique maintenant:"
"Mon stop loss ne bouge JAMAIS"
"Sauf pour le remonter en profit (trailing)"
"Set and forget."

SLIDE 5 (CTA):
"Tu as deja fait cette erreur?"
"Commente 🙋 si oui"
"Enregistre ce post pour t'en souvenir"`,
                    instructions: `DESIGN CAROUSEL:
- Slide 1: Rouge/dramatique pour l'attention
- Slides 2-4: Fond sombre, texte clair
- Slide 5: Plus leger, invitant

TEMPLATE:
- Format 1080x1350
- Typo bold et lisible
- Max 3-4 lignes par slide
- Icones/emojis pour illustrer

PUBLICATION:
- Caption courte (l'essentiel est dans le carousel)
- CTA dans caption aussi
- Hashtags trading + mindset`,
                    cta: 'Engagement via commentaire + save',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Canva'],
                    checklist: ['Identifier une vraie erreur perso', 'Creer le carousel (5 slides)', 'Verifier lisibilite sur mobile', 'Ecrire caption courte', 'Programmer publication']
                },
                {
                    title: 'Day in my Life',
                    type: 'Reel',
                    duration: '60-90s',
                    hook: 'Une journee de trader a Tahiti (pas ce que tu crois)',
                    script: `5:30 - REVEIL (5s)
[Reveil naturel, pas d'alarme]
"Pas de reveil. Le soleil fait le job."

6:00 - ROUTINE MATINALE (10s)
[Cafe, check telephone]
"Cafe + check des alertes overnight"
"2 signaux du scanner pendant la nuit"

7:00 - SESSION ASIE (15s)
[Au bureau, analyse]
"Session asiatique presque terminee"
"J'analyse les setups, je valide ou pas"

9:00 - SPORT (10s)
[Paddle, surf, ou gym]
"Le trading c'est bien, mais faut bouger"

12:00 - DEJEUNER (5s)
[Repas simple]
"Repas leger, l'apres-midi sera charge"

14:00 - SESSION LONDON (15s)
[Retour au bureau]
"Session de Londres - la plus volatile"
"C'est la que je fais mes meilleurs trades"

17:00 - CLOTURE (10s)
[Check resultats]
"Journee terminee: +23 pips"
"Je prends les profits, je ferme tout"

18:00 - SUNSET (10s)
[Vue sunset, lifestyle]
"Le reste de la journee? C'est pour vivre."

OUTRO (10s)
"Ca c'est ma vie de trader a Tahiti"
"Pas de bureau, pas de patron, pas de stress"`,
                    instructions: `TOURNAGE:
- Filme VRAIMENT ta journee (pas de fake)
- Mix de plans: POV, face cam, plans larges
- Golden hour pour les moments outdoor
- Montre les vrais ecrans avec vrais trades

MONTAGE:
- Rythme dynamique, cuts rapides
- Musique upbeat/motivante
- Timestamps en overlay
- Sous-titres obligatoires

AUTHENTICITE:
- Montre aussi les moments "normaux"
- Pas que du glamour
- Les gens veulent du vrai`,
                    cta: 'Lien en bio pour decouvrir le scanner',
                    ctaLevel: 'Soft',
                    equipment: ['Telephone toute la journee', 'Trepied portatif', 'Batterie externe'],
                    checklist: ['Planifier les moments a filmer', 'Charger batteries', 'Filmer des le reveil', 'Varier les angles', 'Noter les timestamps', 'Prevoir 2h de montage']
                },
                {
                    title: 'Community Shoutout',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Screenshot DM/commentaire d\'un membre',
                            duration: '5s',
                            instruction: 'Montrer un temoignage authentique'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Face cam: felicitations + context',
                            duration: '10-15s',
                            instruction: 'Celebrer le succes du membre'
                        },
                        {
                            act: 'CTA',
                            content: 'Sticker mention pour le taguer',
                            duration: '5s',
                            instruction: 'Engagement communaute'
                        }
                    ],
                    hook: 'Un membre de la communaute vient de...',
                    script: `STORY 1:
[Screenshot DM/commentaire]
"@membre vient de closer son premier trade gagnant!"
Texte: "🔥 BRAVO"

STORY 2:
[Face cam]
"Yo! Je voulais partager ca avec vous.
[Prenom] vient de faire son premier +20 pips.
Ca fait X semaines qu'il bosse, qu'il apprend.
Et la, ca a paye.
C'est exactement pour ca que je fais tout ca.
Bravo [Prenom]!"

STORY 3:
"Tu veux etre le prochain?"
Sticker mention: @membre
Sticker question: "C'est quoi TON objectif?"`,
                    instructions: `SELECTION DU MEMBRE:
- Temoignage reel et verifiable
- Demander la permission avant de poster
- Celebrer les petites victoires aussi

AUTHENTICITE:
- Felicitations sinceres
- Pas de fake testimonials
- Engage vraiment avec la communaute`,
                    cta: 'Sticker question pour engagement',
                    ctaLevel: 'Ultra Soft',
                    equipment: ['DMs/commentaires recents', 'Telephone'],
                    checklist: ['Identifier un membre a mettre en avant', 'Demander permission', 'Preparer le shoutout', 'Taguer correctement']
                },
                {
                    title: 'Throwback',
                    type: 'Post',
                    duration: 'Carousel avant/apres',
                    hook: 'Il y a 3 ans vs Aujourd\'hui...',
                    script: `CAPTION:
Il y a 3 ans vs Aujourd'hui

📸 Photo 1: Mon "setup" de l'epoque
→ Laptop sur le lit
→ Wifi du voisin
→ Compte a 200€
→ 0 idee de ce que je faisais

📸 Photo 2: Mon setup aujourd'hui
→ Bureau face a l'ocean
→ 2 ecrans
→ Scanner IA
→ Systeme qui tourne tout seul

Qu'est-ce qui a change?

Pas mon intelligence.
Pas ma chance.
Pas mon capital de depart.

J'ai change:
→ Ma discipline
→ Mon approche (systematique vs emotionnel)
→ Mon environnement
→ Les gens autour de moi

Le trading m'a tout appris sur moi-meme.
Les pertes m'ont forge.
Les gains m'ont confirme.

Si tu galeres aujourd'hui, c'est NORMAL.
Continue. Apprends. Adapte-toi.

Dans 3 ans, tu te retourneras aussi.

---
#throwback #evolution #trading #journey #growth`,
                    instructions: `PHOTOS:
- Vraies photos d'archive (pas de fake)
- Montrer le contraste reel
- Humilite sur les debuts

CAROUSEL:
- Slide 1: Photo "avant" avec texte
- Slide 2: Photo "apres" avec texte
- Slide 3: Les 3-4 changements cles
- Slide 4: Message d'encouragement

AUTHENTICITE:
- Partager les vrais struggles
- Pas de "je suis parti de rien"
- Honnete sur le parcours`,
                    cta: 'Engagement via commentaire',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Photos archives', 'Photos actuelles', 'Canva'],
                    checklist: ['Retrouver photos d\'archive', 'Creer le contraste visuel', 'Ecrire texte authentique', 'Verifier que les photos sont postables']
                },
                {
                    title: 'Live Trading',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Video: "Je viens de recevoir un signal"',
                            duration: '5-10s',
                            instruction: 'Montrer notification Telegram en direct'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Screen record de l\'execution du trade',
                            duration: '10-15s',
                            instruction: 'Entry en live sur le broker'
                        },
                        {
                            act: 'CTA',
                            content: 'Screenshot position + "Execution en 0.2s"',
                            duration: '5s',
                            instruction: 'Montrer la rapidite du broker'
                        }
                    ],
                    hook: 'Trade en direct - regardez bien...',
                    script: `STORY 1:
[Video avec notification]
"Signal a l'instant sur AUDUSD"
Montrer la notification Telegram qui pop

STORY 2:
[Screen record broker]
"On execute..."
Montrer l'ouverture du trade en live
Entry, stop loss, take profit

STORY 3:
[Screenshot position]
"Position ouverte"
"Entry: 0.6542"
"Stop: 0.6520"
"TP: 0.6589"
"Execution en 0.2 secondes"

+ Update plus tard avec resultat`,
                    instructions: `TIMING:
- Attendre un vrai signal
- Filmer DES que la notification arrive
- Pas de mise en scene

SCREEN RECORD:
- Avoir l'app prete a enregistrer
- Montrer l'execution rapide
- Flouter si besoin le solde

SUIVI:
- Poster update quand le trade close
- Win ou loss, montrer le resultat`,
                    cta: 'Demo credibilite = CTA implicite',
                    ctaLevel: 'Direct (demo en live)',
                    equipment: ['Broker ouvert', 'Screen recorder pret', 'Telegram visible'],
                    checklist: ['Avoir le broker ouvert', 'Avoir Telegram visible', 'Screen recorder pret', 'Attendre un signal', 'Filmer immediatement', 'Poster rapidement']
                },
                {
                    title: 'Weekend Vibes',
                    type: 'Post',
                    duration: 'Photo/Carousel lifestyle',
                    hook: 'Le weekend c\'est sacre. Pas de charts.',
                    script: `CAPTION:
Le weekend c'est sacre.

Pas de charts.
Pas de trades.
Pas de stress.

Le marche sera la lundi.
Mes setups seront la lundi.
Le scanner tourne en fond et m'alertera si besoin.

Mais ce weekend?

→ Paddle au lever du soleil
→ BBQ avec les potes
→ Guitare sur la terrasse
→ Zero ecran (sauf pour cette photo 📸)

C'est ca aussi etre trader.
Savoir quand NE PAS trader.
Savoir profiter de ce que le trading permet.

Tu fais quoi ce weekend?

---
#weekend #lifestyle #tahiti #trader #balance #freedom`,
                    instructions: `PHOTOS:
- Vraie activite du weekend
- Pas de laptop dans le cadre
- Montrer le lifestyle, pas le trading
- Qualite et lumiere naturelle

VIBE:
- Relaxe, pas "hustle"
- Montrer l'equilibre
- Authenticite > perfection

TIMING:
- Poster samedi matin ou dimanche soir
- Quand les gens sont aussi en mode weekend`,
                    cta: 'Question engagement, pas de CTA broker',
                    ctaLevel: 'Pas de CTA broker',
                    equipment: ['Telephone', 'Activite lifestyle'],
                    checklist: ['Planifier activite weekend', 'Prendre photos pendant', 'Selectionner les meilleures', 'Poster quand tu vis le moment']
                }
            ];

            // =====================
            // CONTENU DETAILLE HIGH VALUE CAPITAL
            // =====================
            const hvcThemes = [
                {
                    title: 'Market Analysis',
                    type: 'Post',
                    duration: 'Image/Carousel',
                    hook: 'AUDUSD cette semaine: voila ce que le scanner detecte',
                    script: `CAPTION:
📊 Analyse AUDUSD - Semaine du [DATE]

Le scanner HVC a identifie 3 zones cles:

🔴 ZONE DE SUPPLY (0.6620-0.6640)
→ Reaction prevue: rejet baissier
→ Confluence: BOS H4 + FVG
→ Probabilite scanner: 72%

🟢 ZONE DE DEMAND (0.6480-0.6500)
→ Reaction prevue: rebond haussier
→ Confluence: Order Block + Liquidity sweep
→ Probabilite scanner: 78%

⚡ NIVEAU CLE: 0.6550
→ Pivot de la semaine
→ Au-dessus = biais haussier
→ En-dessous = biais baissier

📈 Mon plan:
- Attendre reaction sur zone de supply
- Si rejet confirme → short vers demand
- Stop au-dessus de la zone
- RR minimum 1:2

Le scanner enverra les alertes en temps reel.
Tu recois les memes signaux que moi.

Lien en bio pour rejoindre.

---
#forex #trading #audusd #analysis #technicalanalysis #smartmoney`,
                    instructions: `VISUEL:
- Screenshot TradingView annote
- Zones clairement marquees (rectangles)
- Fleches pour les mouvements attendus
- Legende avec couleurs

ANNOTATIONS:
- Zone Supply = Rouge
- Zone Demand = Vert
- Niveau cle = Ligne jaune
- BOS/FVG = Marques distinctes

FORMAT:
- Image unique ou Carousel
- Si carousel: 1 zone par slide
- Derniere slide = recap plan`,
                    cta: 'Lien en bio pour rejoindre HVC',
                    ctaLevel: 'Direct',
                    equipment: ['TradingView', 'Outil annotation', 'Canva (optionnel)'],
                    checklist: ['Analyser la paire sur H4/Daily', 'Identifier les zones du scanner', 'Annoter le chart proprement', 'Ecrire le plan de trade', 'Verifier confluences', 'Poster debut de semaine']
                },
                {
                    title: 'Signal Alert',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Screenshot notification Telegram du scanner',
                            duration: '5s',
                            instruction: 'Montrer l\'alerte brute'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Screen record: analyse rapide sur TradingView',
                            duration: '15-20s',
                            instruction: 'Montrer BOS, zone, entry potentielle'
                        },
                        {
                            act: 'CTA',
                            content: 'Texte: "Tu veux recevoir ces alertes?" + lien',
                            duration: '5s',
                            instruction: 'CTA direct vers inscription'
                        }
                    ],
                    hook: '🚨 Signal HVC a l\'instant',
                    script: `STORY 1:
[Screenshot Telegram]
🚨 SIGNAL HVC
Paire: GBPUSD
Direction: LONG
Zone: 1.2650-1.2665
Probabilite: 76%
Texte: "Signal frais du scanner"

STORY 2:
[Screen record TradingView 15-20s]
"Regardez le setup..."
- Montrer le BOS
- Montrer la zone de demand
- Montrer ou placer entry/SL/TP
"Setup valide, j'execute"

STORY 3:
[Texte sur fond HVC]
"Tu veux recevoir ces alertes?"
"24/7, directement sur Telegram"
"👉 Lien en bio"`,
                    instructions: `STORY 1:
- Screenshot propre de la notification
- Pas de modifications
- Urgence visuelle (emoji 🚨)

STORY 2:
- TradingView propre et clair
- Zoom sur la zone
- Explications voix off ou texte
- Max 20 secondes

STORY 3:
- Background couleurs HVC (bleu/violet)
- CTA clair et lisible
- Sticker lien si disponible`,
                    cta: 'Lien en bio pour s\'inscrire',
                    ctaLevel: 'Direct',
                    equipment: ['Scanner actif', 'TradingView', 'Screen recorder'],
                    checklist: ['Attendre un signal', 'Screenshot immediatement', 'Analyser rapidement sur TV', 'Poster dans les 10 minutes']
                },
                {
                    title: 'Education: BOS',
                    type: 'Reel',
                    duration: '60-90s',
                    hook: 'Le BOS explique en 60 secondes (meme ta grand-mere comprendrait)',
                    script: `INTRO (0-5s):
"Le Break of Structure en 60 secondes"
[Chart vierge]

PARTIE 1 - C'EST QUOI (5-20s):
"Un BOS c'est quand le prix casse un niveau important"
[Dessine structure HH/HL]
"En tendance haussiere, on fait des Higher Highs et Higher Lows"
"Quand le prix casse un Higher Low..."
[Anime la cassure]
"C'est un Break of Structure"

PARTIE 2 - POURQUOI C'EST IMPORTANT (20-40s):
"Le BOS te dit que les gros joueurs ont change d'avis"
"Avant: ils achetaient"
"Apres le BOS: ils vendent"
[Montre le changement de direction]
"C'est le PREMIER signe d'un retournement"

PARTIE 3 - COMMENT L'UTILISER (40-55s):
"Apres un BOS, cherche:"
"1. Un retour vers la zone de l'ancien support"
"2. Un rejet de cette zone"
"3. Entry short avec stop au-dessus"
[Montre le setup complet]

OUTRO (55-65s):
"Le scanner HVC detecte automatiquement les BOS"
"Tu recois l'alerte, tu executes"
"Lien en bio"`,
                    instructions: `TOURNAGE:
- Screen record TradingView
- Utilise l'outil dessin en direct
- Parle en meme temps que tu dessines
- Vitesse normale (pas accelere)

DESSIN:
- Couleurs distinctes (vert=haussier, rouge=baissier)
- Fleches pour montrer les mouvements
- Encadre les zones importantes
- Labels clairs (HH, HL, BOS)

MONTAGE:
- Sous-titres OBLIGATOIRES
- Texte overlay pour les points cles
- Musique educative en fond (low volume)
- Zoom sur les moments importants`,
                    cta: 'Scanner detecte les BOS - Lien en bio',
                    ctaLevel: 'Soft',
                    equipment: ['TradingView avec outils dessin', 'Screen recorder', 'Micro pour voix off'],
                    checklist: ['Trouver un exemple de BOS recent', 'Preparer le chart vierge', 'Ecrire le script', 'Faire plusieurs prises', 'Ajouter sous-titres', 'Verifier la clarte']
                },
                {
                    title: 'Weekly Results',
                    type: 'Post',
                    duration: 'Stats visuelles',
                    hook: 'Resultats du scanner HVC - Semaine #XX',
                    script: `CAPTION:
📊 Resultats Scanner HVC - Semaine #XX

Signaux envoyes: 12
Trades gagnants: 9
Trades perdants: 3

Win Rate: 75%
Pips total: +127
RR moyen: 1:2.4

🏆 Meilleur trade:
AUDUSD LONG +43 pips
Setup: BOS H4 + Zone de demand + FVG
Le scanner avait donne 82% de probabilite

❌ Pire trade:
EURUSD SHORT -18 pips
Invalide par news NFP
(Rappel: toujours check le calendrier eco)

📈 Performance depuis le lancement:
Mois en cours: +312 pips
Depuis janvier: +847 pips
Win rate global: 71%

Ces resultats sont documentes et verifiables.
Chaque signal est enregistre avec timestamp.

Tu veux trader avec nous?
Lien en bio.

---
#trading #forex #results #scanner #performance #hvc`,
                    instructions: `VISUEL:
- Template HVC (couleurs bleu/violet)
- Stats en gros chiffres
- Graphique de performance (optionnel)
- Credibilite = captures d'ecran

FORMAT:
- Image unique avec toutes les stats
- OU Carousel avec breakdown par trade
- Derniere slide = CTA

CREDIBILITE:
- Timestamps sur les trades
- Screenshots des entries/exits
- Transparence sur les pertes aussi`,
                    cta: 'Lien en bio pour rejoindre',
                    ctaLevel: 'Direct',
                    equipment: ['Historique des signaux', 'Canva', 'Screenshots trades'],
                    checklist: ['Compiler stats de la semaine', 'Calculer win rate et pips', 'Identifier meilleur/pire trade', 'Creer visuel professionnel', 'Verifier tous les chiffres']
                },
                {
                    title: 'Temoignage Client',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Screenshot DM temoignage',
                            duration: '5s',
                            instruction: 'Message authentique d\'un membre'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Face cam: context et felicitations',
                            duration: '15s',
                            instruction: 'Expliquer le parcours du membre'
                        },
                        {
                            act: 'CTA',
                            content: '"Rejoins [Prenom] et les autres"',
                            duration: '5s',
                            instruction: 'CTA vers inscription'
                        }
                    ],
                    hook: 'Message recu ce matin d\'un membre HVC...',
                    script: `STORY 1:
[Screenshot DM]
"Premier mois positif grace au scanner!"
"J'ai fait +89 pips en suivant les signaux"
"Merci HVC!"
Texte overlay: "Message de @membre"

STORY 2:
[Face cam ou voix off]
"[Prenom] a rejoint HVC il y a 6 semaines
Au debut il doutait, comme tout le monde
Il a suivi les signaux a la lettre
Premier mois: +89 pips
C'est exactement pour ca qu'on a cree le scanner
Bravo [Prenom]!"

STORY 3:
[Texte sur fond HVC]
"Rejoins [Prenom] et +200 membres"
"Scanner IA + Communaute + Formation"
"👉 Lien en bio"`,
                    instructions: `SELECTION:
- Temoignage REEL uniquement
- Demander permission avant de poster
- Flouter nom complet si demande

PRESENTATION:
- Celebrer le membre
- Donner du contexte (depuis combien de temps, etc.)
- Rester humble (pas de promesses)

CREDIBILITE:
- Screenshots non modifies
- Dates visibles si possible
- Temoignages verifiables`,
                    cta: 'Rejoindre la communaute - Lien en bio',
                    ctaLevel: 'Direct',
                    equipment: ['DM authentique', 'Permission du membre'],
                    checklist: ['Identifier un temoignage recent', 'Demander permission', 'Verifier l\'authenticite', 'Preparer le shoutout']
                },
                {
                    title: 'Promo Formation',
                    type: 'Post',
                    duration: 'Carousel 5-7 slides',
                    hook: 'Ce que tu obtiens en rejoignant HVC (et ce que ca vaut vraiment)',
                    script: `SLIDE 1 (HOOK):
"Ce que tu obtiens avec HVC"
[Background premium]

SLIDE 2 (SCANNER):
"🤖 Scanner IA 24/7"
→ Detection automatique des setups
→ Alertes Telegram en temps reel
→ Probabilites calculees
Valeur: Incalculable (des heures d'analyse economisees)

SLIDE 3 (SIGNAUX):
"📊 +10 signaux/semaine"
→ Entries precises
→ Stop loss et take profit
→ Suivi en temps reel
Win rate historique: 71%

SLIDE 4 (FORMATION):
"📚 Formation complete"
→ Cours video structures
→ De debutant a avance
→ Mises a jour regulieres
+20h de contenu

SLIDE 5 (COMMUNAUTE):
"👥 Communaute active"
→ +200 membres
→ Discussions quotidiennes
→ Partage de trades
→ Support entre membres

SLIDE 6 (SUPPORT):
"🎯 Support personnalise"
→ Questions reponses
→ Review de tes trades
→ Accompagnement

SLIDE 7 (CTA):
"Pret a passer au niveau superieur?"
"Lien en bio"
[Arrow pointing down]`,
                    instructions: `DESIGN:
- Cohérence visuelle HVC
- Un benefice par slide
- Icones/emojis pour illustrer
- Pas trop de texte par slide

PRICING:
- Ne pas mentionner le prix dans le post
- Laisser la curiosite amener au lien
- Le prix est sur la page de vente

URGENCE (optionnel):
- "Places limitees"
- "Offre de lancement"
- Seulement si c'est vrai`,
                    cta: 'Lien en bio pour voir l\'offre',
                    ctaLevel: 'Direct',
                    equipment: ['Canva', 'Assets HVC'],
                    checklist: ['Lister tous les benefices', 'Creer slides coherentes', 'Verifier l\'ordre logique', 'CTA clair a la fin', 'Programmer aux heures de pointe']
                },
                {
                    title: 'Zone de Recharge',
                    type: 'Reel',
                    duration: '45-60s',
                    hook: 'Comment identifier une zone de DEMAND en 45 secondes',
                    script: `INTRO (0-5s):
"Zone de demand: le guide complet"
[Chart exemple]

ETAPE 1 (5-15s):
"Etape 1: Trouve un mouvement impulsif"
[Montre une grosse bougie verte]
"Une grosse bougie qui casse un niveau"
"Ca c'est l'impulsion"

ETAPE 2 (15-25s):
"Etape 2: Identifie l'origine"
[Remonte a la base du mouvement]
"La derniere bougie rouge avant l'impulsion"
"C'est la que les acheteurs sont entres"

ETAPE 3 (25-35s):
"Etape 3: Dessine la zone"
[Dessine rectangle]
"Du bas de la meche au corps de la bougie"
"C'est ta zone de demand"

ETAPE 4 (35-45s):
"Etape 4: Attends le retour"
[Montre le prix qui revient]
"Quand le prix revient dans la zone..."
"C'est ton entry LONG"
"Stop sous la zone, TP au-dessus du dernier high"

OUTRO (45-55s):
"Le scanner HVC fait ca automatiquement"
"Tu recois l'alerte, tu executes"
"Lien en bio"`,
                    instructions: `CHART:
- Exemple reel et recent
- Timeframe H1 ou H4
- Zoom sur la zone
- Couleurs claires

DESSIN EN DIRECT:
- Utilise les outils TradingView
- Rectangle pour la zone
- Fleches pour les mouvements
- Labels pour les etapes

PEDAGOGIE:
- Une etape a la fois
- Repete les points cles
- Exemple concret > theorie`,
                    cta: 'Scanner detecte les zones - Lien en bio',
                    ctaLevel: 'Soft',
                    equipment: ['TradingView', 'Exemple recent', 'Screen recorder'],
                    checklist: ['Trouver un exemple propre', 'Preparer les annotations', 'Ecrire le script', 'Filmer en dessinant', 'Ajouter sous-titres', 'Verifier pedagogie']
                },
                {
                    title: 'Live Q&A',
                    type: 'Story',
                    isSequence: true,
                    duration: '3-5 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Sticker Question "Pose ta question trading"',
                            duration: '24h',
                            instruction: 'Collecter les questions'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Face cam: repondre aux meilleures questions',
                            duration: '15-30s par question',
                            instruction: '2-3 questions selectionnees'
                        },
                        {
                            act: 'CTA',
                            content: '"Plus de reponses dans la communaute HVC"',
                            duration: '5s',
                            instruction: 'Rediriger vers le groupe'
                        }
                    ],
                    hook: 'Je reponds a vos questions trading...',
                    script: `STORY 1 (24h AVANT):
[Sticker Question]
"Pose ta question trading"
"Je reponds demain"

STORY 2:
[Face cam - Question 1]
"@membre demande: Comment gerer le FOMO?"
[Reponse 20-30s]
"Le FOMO c'est l'ennemi #1..."

STORY 3:
[Face cam - Question 2]
"@membre demande: Quel capital pour commencer?"
[Reponse 20-30s]
"Alors la vraie question c'est..."

STORY 4:
[Face cam - Question 3]
"@membre demande: Le scanner marche sur toutes les paires?"
[Reponse 20-30s]
"On focus sur 6 paires principales..."

STORY 5:
[Texte sur fond]
"D'autres questions?"
"Rejoins la communaute HVC"
"On repond a tout, tous les jours"
"👉 Lien en bio"`,
                    instructions: `COLLECTE:
- Poster le sticker 24h avant
- Selectionner 3-5 questions pertinentes
- Mix debutant + avance

REPONSES:
- Face cam, regarde la camera
- Reponses concises (30s max)
- Valeur reelle, pas de bullshit
- Mention le membre qui a pose

FORMAT:
- Une question par story
- Taguer le membre
- Finir par CTA vers communaute`,
                    cta: 'Rejoindre communaute pour Q&A illimite',
                    ctaLevel: 'Soft',
                    equipment: ['Sticker Question', 'Bonnes questions collectees'],
                    checklist: ['Poster sticker 24h avant', 'Collecter les questions', 'Selectionner les meilleures', 'Preparer les reponses', 'Filmer face cam', 'Finir par CTA']
                },
                {
                    title: 'Backtest Results',
                    type: 'Post',
                    duration: 'Carousel stats',
                    hook: 'On a backtest le scanner sur 2 ans de data. Voila les resultats.',
                    script: `CAPTION:
📊 Backtest Scanner HVC - 2 ans de data

On a fait tourner l'algo sur 2 ans de donnees historiques.
Voila ce qu'on a trouve:

AUDUSD:
→ 312 signaux
→ Win rate: 73%
→ Profit factor: 2.1
→ +1,847 pips

GBPUSD:
→ 287 signaux
→ Win rate: 69%
→ Profit factor: 1.9
→ +1,523 pips

EURUSD:
→ 298 signaux
→ Win rate: 71%
→ Profit factor: 2.0
→ +1,692 pips

Total sur 6 paires:
→ 1,789 signaux
→ Win rate moyen: 71%
→ +8,234 pips en 2 ans

⚠️ Disclaimer:
Les performances passees ne garantissent pas les resultats futurs.
Le trading comporte des risques.
Ne risque que ce que tu peux perdre.

Ces donnees sont la pour montrer la robustesse de l'approche.
Le scanner utilise exactement la meme logique.

Lien en bio pour plus d'infos.

---
#backtest #trading #forex #data #performance #statistics`,
                    instructions: `DONNEES:
- Backtest reel et documenté
- Periode clairement indiquee
- Disclaimer obligatoire
- Ne pas exagerer

VISUEL:
- Tableaux clairs
- Graphiques de performance
- Couleurs coherentes
- Source des donnees

CREDIBILITE:
- Montrer les periodes difficiles aussi
- Max drawdown mentionne
- Transparence totale`,
                    cta: 'Lien en bio pour details',
                    ctaLevel: 'Soft',
                    equipment: ['Donnees de backtest', 'Excel/Sheets', 'Canva'],
                    checklist: ['Compiler donnees backtest', 'Calculer toutes les metriques', 'Creer visuels', 'Ajouter disclaimer', 'Verifier tous les chiffres']
                },
                {
                    title: 'Risk Management',
                    type: 'Reel',
                    duration: '60-90s',
                    hook: 'La regle qui m\'a sauve 10 comptes (et que 90% ignorent)',
                    script: `INTRO (0-5s):
"La regle des 1% qui change tout"
[Texte dramatique]

LE PROBLEME (5-20s):
"La plupart des traders debutants..."
"Risquent 10%, 20%, parfois 50% par trade"
"Un trade qui tourne mal = compte detruit"
[Montre un compte qui explose]

LA REGLE (20-40s):
"La regle des 1%:"
"Ne JAMAIS risquer plus de 1% de ton capital par trade"
[Calcul visuel]
"Compte 1000€ = 10€ de risque max"
"Compte 10,000€ = 100€ de risque max"

POURQUOI CA MARCHE (40-60s):
"Avec 1% de risque:"
"Tu peux perdre 10 trades d'affilee..."
"Et garder 90% de ton capital"
"Tu survis assez longtemps pour apprendre"
[Graphique de survie]

APPLICATION (60-75s):
"Comment calculer ta taille de position:"
"1. Determine ton risque en € (1% du compte)"
"2. Mesure la distance de ton stop loss en pips"
"3. Divise le risque par les pips"
"= Ta taille de lot"

OUTRO (75-85s):
"Le scanner HVC calcule ca automatiquement"
"Tu recois le signal avec la taille de position"
"Zero calcul, zero erreur"`,
                    instructions: `VISUEL:
- Calculs clairs et lisibles
- Exemples concrets avec chiffres
- Animation des calculs si possible
- Graphique de survie du compte

PEDAGOGIE:
- Concept simple avant complique
- Exemple reel
- Montrer le "pourquoi" pas juste le "comment"

CREDIBILITE:
- Avouer ses propres erreurs passees
- Pas de promesses de gains
- Focus sur la protection du capital`,
                    cta: 'Scanner calcule taille position - Lien en bio',
                    ctaLevel: 'Soft',
                    equipment: ['Calculatrice/Excel pour demo', 'TradingView', 'Screen recorder'],
                    checklist: ['Preparer exemples de calcul', 'Creer visuels explicatifs', 'Ecrire script pedagogue', 'Filmer avec clarte', 'Ajouter sous-titres']
                },
                {
                    title: 'Scanner Update',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Texte: "Nouvelle mise a jour du scanner 🚀"',
                            duration: '5s',
                            instruction: 'Creer l\'excitation'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Screen record des nouvelles fonctionnalites',
                            duration: '15-20s',
                            instruction: 'Demo en direct'
                        },
                        {
                            act: 'CTA',
                            content: '"Dispo maintenant pour tous les membres"',
                            duration: '5s',
                            instruction: 'FOMO pour non-membres'
                        }
                    ],
                    hook: '🚀 Mise a jour scanner HVC',
                    script: `STORY 1:
[Texte anime]
"🚀 SCANNER UPDATE"
"Nouvelle fonctionnalite disponible"

STORY 2:
[Screen record]
"On vient d'ajouter..."
[Montrer la nouvelle feature]
"Maintenant vous recevez aussi..."
[Demo en direct]
"Ca change tout pour..."

STORY 3:
[Texte sur fond]
"Disponible MAINTENANT"
"Pour tous les membres HVC"
"Tu veux y acceder?"
"👉 Lien en bio"`,
                    instructions: `TIMING:
- Poster des qu'une update est live
- Creer l'excitation
- Montrer la valeur ajoutee

DEMO:
- Montrer la feature en action
- Expliquer le benefice concret
- Pas trop technique

FOMO:
- "Pour les membres uniquement"
- Crée l'envie de rejoindre`,
                    cta: 'Rejoindre pour acceder aux updates',
                    ctaLevel: 'Direct',
                    equipment: ['Nouvelle feature', 'Screen recorder'],
                    checklist: ['Preparer la demo', 'Tester la feature', 'Filmer proprement', 'Poster rapidement']
                },
                {
                    title: 'Success Story',
                    type: 'Post',
                    duration: 'Carousel temoignage',
                    hook: 'De -2000€ a +500€/mois: le parcours de Thomas avec HVC',
                    script: `SLIDE 1:
"Le parcours de Thomas"
"Membre HVC depuis 8 mois"
[Photo ou avatar]

SLIDE 2 - AVANT:
"Il y a 8 mois:"
→ 2 ans de trading
→ -2000€ de pertes totales
→ 0 strategie claire
→ Trading emotionnel
"Il etait pret a abandonner"

SLIDE 3 - LE DECLIC:
"Ce qui a change:"
→ Decouverte de HVC
→ Scanner = plus de FOMO
→ Regles claires a suivre
→ Communaute de support
"Il a decide de suivre le systeme"

SLIDE 4 - LE PROCESSUS:
"Mois 1-2: Apprentissage"
→ Formation complete
→ Paper trading avec signaux
→ 0 argent reel

"Mois 3-4: Premiers trades"
→ Micro lots uniquement
→ +47 pips premier mois
→ Confiance qui revient

SLIDE 5 - AUJOURD'HUI:
"8 mois plus tard:"
→ +500€/mois en moyenne
→ Win rate 68%
→ Gestion du risque maitrisee
→ Trading = revenus complementaires

SLIDE 6 - CONSEIL DE THOMAS:
"Mon conseil: fais confiance au systeme"
"Les premiers mois j'avais envie de modifier"
"J'ai suivi les regles, ca a paye"

SLIDE 7 - CTA:
"Tu veux ecrire ta propre success story?"
"Rejoins Thomas et +200 membres"
"👉 Lien en bio"`,
                    instructions: `AUTHENTICITE:
- Histoire REELLE uniquement
- Permission du membre
- Pas d'exageration
- Montrer aussi les difficultes

STRUCTURE:
- Situation avant (relatable)
- Le changement (HVC)
- Le processus (pas magique)
- Les resultats (realistes)

CREDIBILITE:
- Chiffres verifiables
- Timeline realiste
- Conseil du membre lui-meme`,
                    cta: 'Rejoindre la communaute - Lien en bio',
                    ctaLevel: 'Direct',
                    equipment: ['Temoignage reel', 'Permission ecrite', 'Canva'],
                    checklist: ['Contacter le membre', 'Collecter son histoire', 'Obtenir permission', 'Creer le carousel', 'Verifier les faits', 'Faire valider par le membre']
                },
                {
                    title: 'Market Outlook',
                    type: 'Story',
                    isSequence: true,
                    duration: '3 stories',
                    sequence: [
                        {
                            act: 'HOOK',
                            content: 'Texte: "Ce que je surveille cette semaine"',
                            duration: '5s',
                            instruction: 'Preview du contenu'
                        },
                        {
                            act: 'CONTENT',
                            content: 'Screenshots TradingView avec zones',
                            duration: '10-15s par paire',
                            instruction: '2-3 paires principales'
                        },
                        {
                            act: 'CTA',
                            content: '"Alertes en temps reel dans HVC"',
                            duration: '5s',
                            instruction: 'Rediriger vers inscription'
                        }
                    ],
                    hook: '👀 A surveiller cette semaine...',
                    script: `STORY 1:
[Texte anime]
"👀 WATCHLIST SEMAINE"
"Ce que je surveille"

STORY 2:
[Screenshot AUDUSD]
"AUDUSD: Zone de supply a 0.6620"
"Si on y arrive → short potentiel"
Fleche montrant la zone

STORY 3:
[Screenshot GBPUSD]
"GBPUSD: Zone de demand a 1.2650"
"On attend le retour"
Fleche montrant la zone

STORY 4:
[Texte sur fond]
"Les alertes en temps reel?"
"C'est dans le groupe HVC"
"👉 Lien en bio"`,
                    instructions: `CONTENU:
- 2-3 paires maximum
- Zones clairement marquees
- Biais simple (long/short/neutre)
- Pas de prediction, des scenarios

TIMING:
- Poster dimanche soir ou lundi matin
- Avant l'ouverture des marches

SUIVI:
- Update en cours de semaine si zones touchees`,
                    cta: 'Alertes temps reel dans HVC',
                    ctaLevel: 'Soft',
                    equipment: ['TradingView analyse', 'Screenshots annotes'],
                    checklist: ['Analyser les paires', 'Identifier les zones cles', 'Preparer screenshots', 'Poster avant ouverture lundi']
                },
                {
                    title: 'Strategy Deep Dive',
                    type: 'Reel',
                    duration: '90-120s',
                    hook: 'Le HVC Concept explique de A a Z (sauvegarde ce Reel)',
                    script: `INTRO (0-10s):
"Le HVC Concept en 2 minutes"
"La strategie complete du scanner"
[Texte: SAUVEGARDE CE REEL]

PARTIE 1 - VUE D'ENSEMBLE (10-25s):
"Le HVC Concept combine 3 elements:"
"1. Structure du marche (BOS)"
"2. Zones de supply/demand"
"3. Confluences (FVG, liquidity)"
[Montre les 3 elements sur un chart]

PARTIE 2 - STRUCTURE (25-45s):
"Etape 1: On identifie la tendance"
[Chart avec HH/HL ou LH/LL]
"En tendance haussiere: on cherche des LONGS"
"Apres un BOS baissier: on switch en SHORT"
"Le BOS nous dit quand changer de biais"

PARTIE 3 - ZONES (45-70s):
"Etape 2: On identifie les zones"
[Montre supply et demand]
"Zone de demand = ou les acheteurs sont entres"
"Zone de supply = ou les vendeurs sont entres"
"On attend que le prix REVIENNE dans ces zones"

PARTIE 4 - CONFLUENCES (70-90s):
"Etape 3: On cherche les confluences"
[Montre FVG, liquidity]
"FVG = desequilibre a combler"
"Liquidity = stops a chasser"
"Plus de confluences = plus de probabilite"

PARTIE 5 - EXECUTION (90-105s):
"Etape 4: On execute"
[Montre entry, SL, TP]
"Entry au retour dans la zone"
"Stop loss sous/au-dessus de la zone"
"Take profit au prochain niveau"
"RR minimum 1:2"

OUTRO (105-120s):
"Le scanner fait tout ca automatiquement"
"24/7, sur 6 paires"
"Tu recois l'alerte, tu executes"
"Lien en bio pour rejoindre"`,
                    instructions: `STRUCTURE:
- Progression logique
- Un concept a la fois
- Exemples visuels
- Recap a la fin

VISUEL:
- Charts reels et recents
- Annotations claires
- Zoom sur les points cles
- Couleurs coherentes

DUREE:
- Plus long que d'habitude (OK pour education)
- Mais reste concis
- Chaque seconde doit apporter de la valeur`,
                    cta: 'Scanner applique cette strategie - Lien en bio',
                    ctaLevel: 'Direct',
                    equipment: ['TradingView avec exemples', 'Script detaille', 'Micro qualite'],
                    checklist: ['Preparer exemples de chaque concept', 'Ecrire script complet', 'Filmer segment par segment', 'Assembler avec transitions', 'Ajouter sous-titres', 'Verifier la clarte']
                },
                {
                    title: 'Community Highlight',
                    type: 'Post',
                    duration: 'Carousel moments communaute',
                    hook: 'Ce qui se passe dans la communaute HVC (tu rates ca)',
                    script: `SLIDE 1:
"INSIDE HVC"
"Ce qui se passe dans le groupe"
[Background communaute]

SLIDE 2:
"📊 Discussions quotidiennes"
[Screenshot du chat - analyses]
"Partage d'analyses entre membres"
"Debat sur les setups"

SLIDE 3:
"🎯 Trades en temps reel"
[Screenshot des trades postes]
"Les membres partagent leurs entries"
"On apprend ensemble"

SLIDE 4:
"💬 Support mutuel"
[Screenshot d'entraide]
"Questions reponses 24/7"
"Jamais seul face au marche"

SLIDE 5:
"🏆 Celebrations"
[Screenshot de wins]
"On celebre les victoires"
"Petites et grandes"

SLIDE 6:
"📚 Formations live"
[Screenshot d'une session]
"Sessions hebdomadaires"
"Q&A avec analyse en direct"

SLIDE 7 - CTA:
"Tu veux faire partie de ca?"
"+200 traders qui s'entraident"
"👉 Lien en bio pour rejoindre"`,
                    instructions: `SCREENSHOTS:
- Vraies conversations (anonymisees si besoin)
- Moments positifs
- Diversite des interactions
- Qualite des echanges

MESSAGE:
- Montrer l'ambiance
- Mettre en avant la valeur communaute
- Pas juste le scanner, les GENS

SELECTION:
- Moments varies
- Pas que des wins
- Entraide, questions, debats`,
                    cta: 'Rejoindre la communaute - Lien en bio',
                    ctaLevel: 'Direct',
                    equipment: ['Screenshots du groupe', 'Canva'],
                    checklist: ['Collecter screenshots varies', 'Anonymiser si necessaire', 'Creer carousel coherent', 'Mettre en avant l\'ambiance']
                }
            ];

            const themes = selectedBrand === 'jordy' ? jordyThemes : hvcThemes;

            // Helper function to generate day sections (defined before use)
            function generateDaySections(daysArr, themesArr) {
                return daysArr.map((date, i) => {
                    const theme = themesArr[i % themesArr.length];
                    const dayName = date.toLocaleDateString('fr-FR', { weekday: 'long' });
                    const dateStr = date.toLocaleDateString('fr-FR', { day: '2-digit', month: 'long' });

                    let ctaLevelClass = 'none';
                    if (theme.ctaLevel) {
                        if (theme.ctaLevel.toLowerCase().includes('ultra')) ctaLevelClass = 'ultra-soft';
                        else if (theme.ctaLevel.toLowerCase().includes('soft')) ctaLevelClass = 'soft';
                        else if (theme.ctaLevel.toLowerCase().includes('direct')) ctaLevelClass = 'direct';
                        else if (theme.ctaLevel.toLowerCase().includes('pas')) ctaLevelClass = 'none';
                    }

                    let sequenceHtml = '';
                    if (theme.isSequence && theme.sequence) {
                        const actsHtml = theme.sequence.map(act =>
                            '<div class="story-act">' +
                            '<div class="story-act-header ' + act.act.toLowerCase() + '">' + act.act + '</div>' +
                            '<div class="story-act-content">' + act.content + '</div>' +
                            '<div class="story-act-instruction">' + act.instruction + '</div>' +
                            '<div class="story-act-duration">⏱ ' + act.duration + '</div>' +
                            '</div>'
                        ).join('');
                        sequenceHtml = '<div class="section-box"><div class="section-title">📱 Sequence Stories (3 Acts)</div><div class="story-sequence">' + actsHtml + '</div></div>';
                    }

                    const equipmentHtml = (theme.equipment || []).map(eq => '<span class="equipment-item">' + eq + '</span>').join('');
                    const checklistHtml = (theme.checklist || []).map(item => '<div class="checklist-item"><div class="checkbox"></div><span class="checklist-text">' + item + '</span></div>').join('');

                    return '<div class="day-section">' +
                        '<div class="day-header-bar">' +
                        '<div class="day-info"><div><div class="day-name">' + dayName + '</div><div class="day-date">' + dateStr + '</div></div></div>' +
                        '<div style="display: flex; align-items: center; gap: 15px;"><span class="content-type">' + theme.type + '</span><span class="duration">' + (theme.duration || '') + '</span></div>' +
                        '</div>' +
                        '<div class="day-content">' +
                        '<div class="content-title">' + theme.title + '</div>' +
                        '<div class="section-box"><div class="section-title">🎣 Hook / Accroche</div><div class="hook-text">"' + (theme.hook || '') + '"</div></div>' +
                        sequenceHtml +
                        '<div class="section-box"><div class="section-title">📝 Script / Contenu Detaille</div><div class="script-text">' + (theme.script || '').replace(/\n/g, '<br>') + '</div></div>' +
                        '<div class="section-box"><div class="section-title">🎬 Instructions de Tournage</div><div class="instructions-text">' + (theme.instructions || '').replace(/\n/g, '<br>') + '</div></div>' +
                        '<div class="two-columns">' +
                        '<div class="section-box"><div class="section-title">📣 Call-to-Action</div><div class="cta-box"><span class="cta-level ' + ctaLevelClass + '">' + (theme.ctaLevel || 'N/A') + '</span><span class="cta-text">' + (theme.cta || '') + '</span></div></div>' +
                        '<div class="section-box"><div class="section-title">🛠 Equipement Necessaire</div><div class="equipment-list">' + equipmentHtml + '</div></div>' +
                        '</div>' +
                        '<div class="section-box"><div class="section-title">✅ Checklist de Production</div><div class="checklist-list">' + checklistHtml + '</div></div>' +
                        '</div></div>';
                }).join('');
            }

            const htmlContent = `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Planner PRO - ${brandName} | ${days.length} Jours</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', sans-serif;
            background: #fff;
            color: #1a1a2e;
            line-height: 1.6;
            padding: 30px;
            font-size: 11px;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: ${brandGradient};
            border-radius: 16px;
            color: white;
        }
        .header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }
        .header .dates {
            margin-top: 12px;
            font-size: 0.85rem;
            opacity: 0.8;
        }
        .day-section {
            margin-bottom: 30px;
            page-break-inside: avoid;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
        }
        .day-header-bar {
            background: ${brandGradient};
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .day-header-bar .day-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .day-header-bar .day-name {
            font-size: 0.8rem;
            text-transform: uppercase;
            opacity: 0.8;
        }
        .day-header-bar .day-date {
            font-size: 1.1rem;
            font-weight: 700;
        }
        .day-header-bar .content-type {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .day-header-bar .duration {
            font-size: 0.75rem;
            opacity: 0.8;
        }
        .day-content {
            padding: 20px;
            background: #fafafa;
        }
        .content-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: ${brandColor};
            margin-bottom: 5px;
        }
        .section-box {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .section-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: ${brandColor};
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: ${brandColor};
            border-radius: 2px;
        }
        .hook-text {
            font-size: 1.1rem;
            font-weight: 600;
            font-style: italic;
            color: #333;
            padding: 10px 15px;
            background: #f5f5f5;
            border-left: 4px solid ${brandColor};
            border-radius: 0 8px 8px 0;
        }
        .script-text {
            white-space: pre-wrap;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            line-height: 1.8;
            color: #333;
        }
        .instructions-text {
            white-space: pre-wrap;
            font-size: 0.85rem;
            line-height: 1.7;
            color: #555;
        }
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .cta-box {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .cta-level {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .cta-level.ultra-soft { background: #d1fae5; color: #065f46; }
        .cta-level.soft { background: #fef3c7; color: #92400e; }
        .cta-level.direct { background: #fee2e2; color: #991b1b; }
        .cta-level.none { background: #f3f4f6; color: #6b7280; }
        .cta-text {
            font-size: 0.9rem;
            color: #333;
        }
        .equipment-list, .checklist-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .equipment-item {
            background: #e0e7ff;
            color: #3730a3;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            border-bottom: 1px dashed #e0e0e0;
        }
        .checklist-item:last-child {
            border-bottom: none;
        }
        .checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #999;
            border-radius: 3px;
            flex-shrink: 0;
        }
        .checklist-text {
            font-size: 0.85rem;
            color: #444;
        }
        /* Story Sequence */
        .story-sequence {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .story-act {
            flex: 1;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
        }
        .story-act-header {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        .story-act-header.hook { background: #fef3c7; color: #92400e; }
        .story-act-header.content { background: #dbeafe; color: #1e40af; }
        .story-act-header.cta { background: #d1fae5; color: #065f46; }
        .story-act-content {
            font-size: 0.8rem;
            color: #333;
            margin-bottom: 8px;
        }
        .story-act-instruction {
            font-size: 0.75rem;
            color: #666;
            font-style: italic;
        }
        .story-act-duration {
            font-size: 0.7rem;
            color: #999;
            margin-top: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #888;
            font-size: 0.8rem;
            border-top: 1px solid #e0e0e0;
        }
        @media print {
            body { padding: 15px; font-size: 10px; }
            .day-section { page-break-inside: avoid; margin-bottom: 20px; }
            .section-box { padding: 10px; margin-bottom: 10px; }
            .header { padding: 20px; margin-bottom: 25px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>📋 CONTENT PLANNER PRO</h1>
        <p>${brandName} - Guide de Production Detaille</p>
        <div class="dates">Du ${days[0].toLocaleDateString('fr-FR', { day: '2-digit', month: 'long', year: 'numeric' })} au ${days[days.length - 1].toLocaleDateString('fr-FR', { day: '2-digit', month: 'long', year: 'numeric' })} (${days.length} jours)</div>
    </div>

    ${generateDaySections(days, themes)}

    <div class="footer">
        <p>📋 Content Planner PRO - Genere le ${new Date().toLocaleDateString('fr-FR', { day: '2-digit', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' })}</p>
        <p style="margin-top: 8px;">${brandName} | HVC Command Center</p>
        <p style="margin-top: 5px; font-size: 0.7rem;">Imprime ce document et coche chaque etape au fur et a mesure</p>
    </div>
</body>
</html>`;

            if (format === 'html') {
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                window.open(url, '_blank');
                showToast('Planning genere!', 'success');
            } else if (format === 'pdf') {
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const printWindow = window.open(url, '_blank');
                printWindow.onload = function() {
                    printWindow.print();
                };
                showToast('Impression PDF lancee!', 'success');
            }

            closeContentPlannerModal();
        }

        // =====================
        // TOAST NOTIFICATIONS
        // =====================

        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };

            const toast = document.createElement('div');
            toast.className = `toast ${colors[type]} px-4 py-3 rounded-lg text-sm font-medium shadow-lg`;
            toast.textContent = message;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // =====================
        // SCANNER STATUS & MODE
        // =====================

        // Configuration heures scanner V7 (UTC) - Optimise backtest 53.2% WR
        const SCANNER_CONFIG = {
            SHORT_HOURS: [3, 14, 15],       // Retire 16h (27.8% WR)
            LONG_HOURS: [3, 17, 19, 22],    // Retire 0h (24.5% WR)
            get ALL_HOURS() { return [...new Set([...this.SHORT_HOURS, ...this.LONG_HOURS])].sort((a,b) => a-b); }
        };

        function getScannerMode() {
            const now = new Date();
            const utcHour = now.getUTCHours();

            const isShortActive = SCANNER_CONFIG.SHORT_HOURS.includes(utcHour);
            const isLongActive = SCANNER_CONFIG.LONG_HOURS.includes(utcHour);

            // Trouver la prochaine fenêtre
            let nextHour = null;
            let nextMode = null;
            for (let i = 1; i <= 24; i++) {
                const checkHour = (utcHour + i) % 24;
                if (SCANNER_CONFIG.ALL_HOURS.includes(checkHour)) {
                    nextHour = checkHour;
                    nextMode = SCANNER_CONFIG.SHORT_HOURS.includes(checkHour) ? 'SHORT' : 'LONG';
                    if (SCANNER_CONFIG.SHORT_HOURS.includes(checkHour) && SCANNER_CONFIG.LONG_HOURS.includes(checkHour)) {
                        nextMode = 'SHORT+LONG';
                    }
                    break;
                }
            }

            // Calculer temps restant
            let hoursUntilNext = nextHour > utcHour ? nextHour - utcHour : 24 - utcHour + nextHour;
            const minutesUntilNext = 60 - now.getUTCMinutes();
            if (minutesUntilNext < 60) hoursUntilNext = Math.max(0, hoursUntilNext - 1);

            return {
                isShortActive,
                isLongActive,
                isActive: isShortActive || isLongActive,
                currentMode: isShortActive && isLongActive ? 'SHORT+LONG' : (isShortActive ? 'SHORT' : (isLongActive ? 'LONG' : 'PAUSE')),
                nextHour,
                nextMode,
                hoursUntilNext,
                minutesUntilNext: minutesUntilNext % 60,
                utcHour
            };
        }

        function updateScannerStatus() {
            const dot = document.getElementById('scanner-status-dot');
            const text = document.getElementById('scanner-status-text');
            const modeIcon = document.getElementById('scanner-mode-icon');
            const modeText = document.getElementById('scanner-mode-text');
            const modeDetail = document.getElementById('scanner-mode-detail');
            const pipsEl = document.getElementById('scanner-pips');
            const winrateEl = document.getElementById('scanner-winrate');

            // Calculer le mode actuel
            const mode = getScannerMode();

            // Afficher le mode
            if (mode.isActive) {
                if (mode.currentMode === 'SHORT+LONG') {
                    modeIcon.textContent = '🔄';
                    modeText.textContent = 'SHORT + LONG';
                    modeText.className = 'text-sm font-medium text-purple-400';
                    modeDetail.textContent = `Recherche SELL et BUY • ${mode.utcHour}h UTC`;
                } else if (mode.currentMode === 'SHORT') {
                    modeIcon.textContent = '📉';
                    modeText.textContent = 'Mode SHORT';
                    modeText.className = 'text-sm font-medium text-red-400';
                    modeDetail.textContent = `Recherche SELL uniquement • ${mode.utcHour}h UTC`;
                } else {
                    modeIcon.textContent = '📈';
                    modeText.textContent = 'Mode LONG';
                    modeText.className = 'text-sm font-medium text-green-400';
                    modeDetail.textContent = `Recherche BUY uniquement • ${mode.utcHour}h UTC`;
                }
                dot.className = 'w-2 h-2 bg-green-500 rounded-full pulse-dot';
                text.className = 'text-xs text-green-400';
                text.textContent = 'Actif';
            } else {
                modeIcon.textContent = '⏸️';
                modeText.textContent = 'En pause';
                modeText.className = 'text-sm font-medium text-gray-400';

                const timeStr = mode.hoursUntilNext > 0
                    ? `${mode.hoursUntilNext}h${mode.minutesUntilNext.toString().padStart(2,'0')}`
                    : `${mode.minutesUntilNext}min`;
                modeDetail.textContent = `Reprise ${mode.nextMode} dans ${timeStr} (${mode.nextHour}h UTC)`;

                dot.className = 'w-2 h-2 bg-gray-500 rounded-full';
                text.className = 'text-xs text-gray-400';
                text.textContent = 'Pause';
            }

            // Calculer stats depuis les trades
            if (trades.length > 0) {
                const closedTrades = trades.filter(t => t.result && t.result !== 'Open');
                const wonTrades = closedTrades.filter(t => t.result === 'TP');
                const totalPips = closedTrades.reduce((sum, t) => sum + (parseFloat(t.pips) || 0), 0);
                const winRate = closedTrades.length > 0 ? (wonTrades.length / closedTrades.length * 100) : 0;

                pipsEl.textContent = totalPips >= 0 ? `+${totalPips.toFixed(1)}` : totalPips.toFixed(1);
                pipsEl.className = totalPips >= 0 ? 'text-lg font-bold text-green-400' : 'text-lg font-bold text-red-400';
                winrateEl.textContent = closedTrades.length > 0 ? `${winRate.toFixed(0)}%` : '--%';
            }
        }

        // Mettre à jour le scanner status toutes les 30 secondes
        setInterval(updateScannerStatus, 30000);

        // =====================
        // CLOCK
        // =====================

        function updateClock() {
            const now = new Date();
            const tahitiOffset = -10 * 60;
            const utcTime = now.getTime() + (now.getTimezoneOffset() * 60000);
            const tahitiTime = new Date(utcTime + (tahitiOffset * 60000));

            const hours = tahitiTime.getHours().toString().padStart(2, '0');
            const minutes = tahitiTime.getMinutes().toString().padStart(2, '0');
            document.getElementById('current-time').textContent = `${hours}:${minutes}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // =====================
        // INIT
        // =====================

        document.addEventListener('DOMContentLoaded', function() {
            // Toujours afficher le mode scanner immédiatement
            updateScannerStatus();

            // Check if API key exists
            if (getApiKey()) {
                loadAllData();
            } else {
                // Show config modal on first load
                openConfigModal();
            }

            // Content Planner date change listeners
            document.getElementById('planner-start-date').addEventListener('change', function() {
                if (selectedBrand) generatePreview();
            });
            document.getElementById('planner-end-date').addEventListener('change', function() {
                if (selectedBrand) generatePreview();
            });
        });

        // Close modal on escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeConfigModal();
            }
        });

        // =====================
        // CONTENT KPI FUNCTIONS
        // =====================

        let kpiData = [];
        let currentKPIFilter = 'all';

        function filterKPIs(brand) {
            currentKPIFilter = brand;
            document.querySelectorAll('.kpi-filter-btn').forEach(btn => {
                btn.classList.remove('bg-purple-500/20', 'text-purple-400');
                btn.classList.add('text-gray-400');
            });
            const activeBtn = document.querySelector(`.kpi-filter-btn[data-filter="${brand}"]`);
            if (activeBtn) {
                activeBtn.classList.add('bg-purple-500/20', 'text-purple-400');
                activeBtn.classList.remove('text-gray-400');
            }
            renderKPIDashboard();
        }

        async function loadContentKPIs() {
            const apiKey = getApiKey();
            const baseId = getBaseId();
            if (!apiKey) return;

            try {
                // Load from unified "Planning Contenu Social" table - only published content with stats
                const kpiResponse = await fetch(`https://api.airtable.com/v0/${baseId}/${CONFIG.tables.content}?maxRecords=100&filterByFormula=OR({Status}='Publie',{Status}='Publié')`, {
                    headers: { 'Authorization': `Bearer ${apiKey}` }
                });

                if (kpiResponse.ok) {
                    const data = await kpiResponse.json();
                    // Map French field names to expected format
                    kpiData = (data.records || []).map(record => ({
                        id: record.id,
                        fields: {
                            Title: record.fields['Titre'] || '',
                            Brand: record.fields['Compte'] || '',
                            Theme: record.fields['Catégorie'] || '',
                            Content_Type: record.fields['Format'] || '',
                            Platform: record.fields['Plateformes'] || '',
                            Post_URL: record.fields['Post_URL'] || record.fields['Lien Publié'] || '',
                            Date_Posted: record.fields['Date Publication'] || '',
                            Likes: record.fields['Likes'] || 0,
                            Comments: record.fields['Commentaires'] || 0,
                            Shares: record.fields['Shares'] || 0,
                            Saves: record.fields['Saves'] || 0,
                            Reach: record.fields['Reach'] || record.fields['Vues'] || 0,
                            Impressions: record.fields['Impressions'] || 0,
                            Engagement_Rate: record.fields['Engagement_Rate'] || 0,
                            Performance_Score: record.fields['Performance_Score'] || 0,
                            Date_Tracked: record.fields['Date_Tracked'] || ''
                        }
                    }));
                    renderKPIDashboard();
                } else {
                    console.error('KPI fetch failed:', kpiResponse.status);
                    kpiData = [];
                    renderKPIDashboard();
                }
            } catch (error) {
                console.error('Error loading KPIs:', error);
                kpiData = [];
                renderKPIDashboard();
            }
        }

        function renderKPIDashboard() {
            // Filter data by brand
            const filtered = currentKPIFilter === 'all'
                ? kpiData
                : kpiData.filter(item => item.fields?.Brand === currentKPIFilter);

            if (filtered.length === 0) {
                document.getElementById('kpi-total-reach').textContent = '-';
                document.getElementById('kpi-total-engagement').textContent = '-';
                document.getElementById('kpi-avg-rate').textContent = '-';
                document.getElementById('kpi-best-type').textContent = '-';
                document.getElementById('kpi-best-theme').textContent = '-';
                document.getElementById('kpi-top-performers').innerHTML = '<p class="text-gray-500 text-sm text-center py-4">Aucune donnee</p>';
                return;
            }

            // Calculate totals
            let totalReach = 0;
            let totalEngagement = 0;
            let engagementRates = [];
            const typePerformance = {};
            const themePerformance = {};

            filtered.forEach(item => {
                const f = item.fields || {};
                totalReach += f.Reach || 0;
                totalEngagement += (f.Likes || 0) + (f.Comments || 0) + (f.Shares || 0) + (f.Saves || 0);
                if (f.Engagement_Rate) engagementRates.push(f.Engagement_Rate);

                const type = f.Content_Type || 'Unknown';
                if (!typePerformance[type]) typePerformance[type] = { total: 0, count: 0 };
                typePerformance[type].total += f.Performance_Score || 0;
                typePerformance[type].count++;

                const theme = f.Theme || 'Unknown';
                if (!themePerformance[theme]) themePerformance[theme] = { total: 0, count: 0 };
                themePerformance[theme].total += f.Performance_Score || 0;
                themePerformance[theme].count++;
            });

            // Find best type and theme
            let bestType = '-';
            let bestTypeScore = 0;
            Object.entries(typePerformance).forEach(([type, data]) => {
                const avg = data.total / data.count;
                if (avg > bestTypeScore) {
                    bestTypeScore = avg;
                    bestType = type;
                }
            });

            let bestTheme = '-';
            let bestThemeScore = 0;
            Object.entries(themePerformance).forEach(([theme, data]) => {
                const avg = data.total / data.count;
                if (avg > bestThemeScore) {
                    bestThemeScore = avg;
                    bestTheme = theme.replace(/_/g, ' ');
                }
            });

            // Update summary cards
            document.getElementById('kpi-total-reach').textContent = formatNumber(totalReach);
            document.getElementById('kpi-total-engagement').textContent = formatNumber(totalEngagement);
            const avgRate = engagementRates.length > 0
                ? (engagementRates.reduce((a, b) => a + b, 0) / engagementRates.length * 100).toFixed(1) + '%'
                : '-';
            document.getElementById('kpi-avg-rate').textContent = avgRate;
            document.getElementById('kpi-best-type').textContent = bestType;
            document.getElementById('kpi-best-theme').textContent = bestTheme.length > 12 ? bestTheme.substring(0, 10) + '...' : bestTheme;

            // Render top performers
            const topPerformers = filtered
                .filter(item => (item.fields?.Performance_Score || 0) > 70)
                .sort((a, b) => (b.fields?.Performance_Score || 0) - (a.fields?.Performance_Score || 0))
                .slice(0, 5);

            if (topPerformers.length === 0) {
                document.getElementById('kpi-top-performers').innerHTML = '<p class="text-gray-500 text-sm text-center py-4">Aucun contenu > 70 de score</p>';
            } else {
                document.getElementById('kpi-top-performers').innerHTML = topPerformers.map((item, i) => {
                    const f = item.fields || {};
                    const score = f.Performance_Score || 0;
                    const scoreColor = score >= 80 ? 'text-green-400' : 'text-yellow-400';
                    const bgColor = score >= 80 ? 'bg-green-500/20' : 'bg-yellow-500/20';
                    return `
                        <div class="flex items-center justify-between p-3 bg-dark-700 rounded-xl">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg ${bgColor} flex items-center justify-center ${scoreColor} text-sm font-bold">${i + 1}</div>
                                <div>
                                    <div class="text-sm font-medium">${f.Theme?.replace(/_/g, ' ') || 'Unknown'}</div>
                                    <div class="text-xs text-gray-500">${f.Brand || '-'} | ${f.Content_Type || '-'}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-bold ${scoreColor}">${score.toFixed(0)}</div>
                                <div class="text-xs text-gray-500">Score</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Render theme chart
            const themeRanking = Object.entries(themePerformance)
                .map(([theme, data]) => ({ theme, avg: data.total / data.count }))
                .sort((a, b) => b.avg - a.avg)
                .slice(0, 6);

            const maxThemeScore = Math.max(...themeRanking.map(t => t.avg), 1);

            document.getElementById('kpi-theme-chart').innerHTML = themeRanking.map(item => {
                const width = (item.avg / maxThemeScore * 100).toFixed(0);
                return `
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">${item.theme.replace(/_/g, ' ')}</span>
                            <span class="text-xs text-gray-500">${item.avg.toFixed(0)}</span>
                        </div>
                        <div class="h-2 bg-dark-600 rounded-full overflow-hidden">
                            <div class="h-full bg-gradient-to-r from-pink-500 to-purple-500 rounded-full transition-all duration-500" style="width: ${width}%"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        // Load KPIs on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadContentKPIs, 1000);
        });

        // =====================
        // TESTIMONIALS SECTION
        // =====================

        let testimonialsData = [];

        async function loadTestimonials() {
            const container = document.getElementById('testimonials-grid');
            if (!container) return;
            container.innerHTML = '<div class="col-span-2 text-center py-8 text-gray-500">Chargement...</div>';

            const result = await airtableFetch(CONFIG.tables.testimonials);
            if (result && result.records) {
                testimonialsData = result.records.map(r => ({
                    id: r.id,
                    name: r.fields['Name'] || r.fields['Nom'] || 'Anonyme',
                    text: r.fields['Testimonial'] || r.fields['Texte'] || r.fields['Content'] || '',
                    platform: r.fields['Platform'] || r.fields['Plateforme'] || r.fields['Source'] || 'Instagram',
                    date: r.fields['Date'] || '',
                    rating: r.fields['Rating'] || r.fields['Note'] || 5,
                    status: r.fields['Status'] || 'Active',
                    screenshot: r.fields['Screenshot'] || null
                }));
                renderTestimonials();
            } else {
                container.innerHTML = '<div class="col-span-2 text-center py-8 text-gray-500">Aucun temoignage trouve</div>';
            }
        }

        function renderTestimonials() {
            const container = document.getElementById('testimonials-grid');
            if (!container) return;
            const filter = document.getElementById('testimonials-filter-rating')?.value || 'all';

            let filtered = testimonialsData;
            if (filter !== 'all') {
                filtered = filtered.filter(t => Math.floor(t.rating) === parseInt(filter));
            }

            if (filtered.length === 0) {
                container.innerHTML = '<div class="col-span-2 text-center py-8 text-gray-500">Aucun temoignage</div>';
                return;
            }

            // Update stats
            const countEl = document.getElementById('testimonials-count');
            const avgEl = document.getElementById('testimonials-avg-rating');
            const pubEl = document.getElementById('testimonials-published');
            if (countEl) countEl.textContent = testimonialsData.length;
            if (avgEl && testimonialsData.length > 0) avgEl.textContent = (testimonialsData.reduce((a, b) => a + b.rating, 0) / testimonialsData.length).toFixed(1);
            if (pubEl) pubEl.textContent = testimonialsData.filter(t => t.status === 'Active' || t.status === 'Published').length;

            container.innerHTML = filtered.map(t => {
                const stars = '★'.repeat(Math.floor(t.rating)) + '☆'.repeat(5 - Math.floor(t.rating));
                const platformColors = {
                    'Instagram': 'bg-pink-500/20 text-pink-400',
                    'Telegram': 'bg-blue-500/20 text-blue-400',
                    'WhatsApp': 'bg-green-500/20 text-green-400',
                    'Email': 'bg-orange-500/20 text-orange-400'
                };
                const platformColor = platformColors[t.platform] || 'bg-gray-500/20 text-gray-400';
                return `
                    <div class="p-4 bg-dark-800 rounded-xl border border-dark-600 card-hover">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center font-bold text-sm">
                                    ${t.name.substring(0, 2).toUpperCase()}
                                </div>
                                <div>
                                    <div class="font-medium">${t.name}</div>
                                    <div class="text-xs text-yellow-400">${stars}</div>
                                </div>
                            </div>
                            <span class="status-badge ${platformColor}">${t.platform}</span>
                        </div>
                        <p class="text-sm text-gray-300 italic">"${t.text.substring(0, 200)}${t.text.length > 200 ? '...' : ''}"</p>
                        ${t.date ? `<div class="text-xs text-gray-500 mt-3">${t.date}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // =====================
        // SIGNALS LOG SECTION
        // =====================

        let signalsData = [];

        async function loadSignals() {
            const container = document.getElementById('signals-table');
            if (!container) return;
            container.innerHTML = '<tr><td colspan="8" class="p-4 text-center text-gray-500">Chargement...</td></tr>';

            const result = await airtableFetch(CONFIG.tables.trades);
            if (result && result.records) {
                signalsData = result.records.map(r => ({
                    id: r.id,
                    tradeId: r.fields['Trade ID'] || '-',
                    symbol: r.fields['Symbol'] || 'AUDUSD',
                    direction: r.fields['Direction'] || '-',
                    entryPrice: r.fields['Entry Price'] || 0,
                    slPrice: r.fields['SL Price'] || 0,
                    tpPrice: r.fields['TP Price'] || 0,
                    pips: r.fields['Pips'] || 0,
                    result: r.fields['Result'] || 'Open',
                    entryTime: r.fields['Entry Time'] || '',
                    closeTime: r.fields['Close Time'] || ''
                })).sort((a, b) => new Date(b.entryTime) - new Date(a.entryTime));
                renderSignals();
            } else {
                container.innerHTML = '<tr><td colspan="8" class="p-4 text-center text-gray-500">Aucun signal trouve</td></tr>';
            }
        }

        function renderSignals() {
            const container = document.getElementById('signals-table');
            if (!container) return;

            const filterPair = document.getElementById('signals-filter-pair')?.value || 'all';
            const filterResult = document.getElementById('signals-filter-result')?.value || 'all';

            let filtered = signalsData;
            if (filterPair !== 'all') {
                filtered = filtered.filter(s => s.symbol === filterPair);
            }
            if (filterResult !== 'all') {
                const resultMap = { 'win': 'Win', 'loss': 'Loss', 'pending': 'Open' };
                filtered = filtered.filter(s => s.result === resultMap[filterResult]);
            }

            // Update stats
            const wins = signalsData.filter(s => s.result === 'Win').length;
            const losses = signalsData.filter(s => s.result === 'Loss').length;
            const winRate = (wins + losses) > 0 ? ((wins / (wins + losses)) * 100).toFixed(0) : 0;

            const totalEl = document.getElementById('signals-total');
            const winsEl = document.getElementById('signals-wins');
            const lossesEl = document.getElementById('signals-losses');
            const winrateEl = document.getElementById('signals-winrate');
            if (totalEl) totalEl.textContent = signalsData.length;
            if (winsEl) winsEl.textContent = wins;
            if (lossesEl) lossesEl.textContent = losses;
            if (winrateEl) winrateEl.textContent = winRate + '%';

            if (filtered.length === 0) {
                container.innerHTML = '<tr><td colspan="8" class="p-4 text-center text-gray-500">Aucun signal</td></tr>';
                return;
            }

            container.innerHTML = filtered.slice(0, 50).map(s => {
                const resultColor = s.result === 'Win' ? 'text-green-400 bg-green-500/20' : s.result === 'Loss' ? 'text-red-400 bg-red-500/20' : 'text-blue-400 bg-blue-500/20';
                const directionColor = s.direction === 'Buy' ? 'text-green-400' : 'text-red-400';
                const pipsColor = s.pips >= 0 ? 'text-green-400' : 'text-red-400';
                return `
                    <tr class="hover:bg-dark-700">
                        <td class="px-4 py-3 text-sm">${s.entryTime ? new Date(s.entryTime).toLocaleDateString('fr-FR') : '-'}</td>
                        <td class="px-4 py-3 font-medium">${s.symbol}</td>
                        <td class="px-4 py-3 text-center"><span class="${directionColor} font-medium">${s.direction}</span></td>
                        <td class="px-4 py-3 text-center text-sm">${s.entryPrice}</td>
                        <td class="px-4 py-3 text-center text-sm text-green-400">${s.tpPrice}</td>
                        <td class="px-4 py-3 text-center text-sm text-red-400">${s.slPrice}</td>
                        <td class="px-4 py-3 text-center"><span class="status-badge ${resultColor}">${s.result}</span></td>
                        <td class="px-4 py-3 text-center font-bold ${pipsColor}">${s.pips >= 0 ? '+' : ''}${s.pips}</td>
                    </tr>
                `;
            }).join('');
        }

        // =====================
        // ONBOARDING SECTION
        // =====================

        let onboardingData = [];

        async function loadOnboarding() {
            const container = document.getElementById('onboarding-members');
            if (!container) return;
            container.innerHTML = '<div class="p-4 text-center text-gray-500">Chargement...</div>';

            const result = await airtableFetch(CONFIG.tables.onboarding);
            if (result && result.records) {
                onboardingData = result.records.map(r => ({
                    id: r.id,
                    step: r.fields['Etape'] || r.fields['Step'] || '-',
                    title: r.fields['Titre'] || r.fields['Title'] || r.fields['Name'] || '-',
                    description: r.fields['Description'] || r.fields['Subject'] || '',
                    order: r.fields['Order'] || r.fields['Ordre'] || r.fields['Jour'] || 0,
                    type: r.fields['Type'] || 'Email',
                    delay: r.fields['Delay'] || r.fields['Delai'] || r.fields['Jour'] || '0',
                    status: r.fields['Status'] || 'Active'
                })).sort((a, b) => a.order - b.order);
                renderOnboarding();
            } else {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune sequence trouvee</div>';
            }
        }

        function renderOnboarding() {
            const container = document.getElementById('onboarding-members');
            if (!container) return;

            if (onboardingData.length === 0) {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune etape configuree</div>';
                return;
            }

            container.innerHTML = onboardingData.map((step, i) => {
                const typeColors = {
                    'Email': 'bg-blue-500/20 text-blue-400',
                    'Telegram': 'bg-cyan-500/20 text-cyan-400',
                    'WhatsApp': 'bg-green-500/20 text-green-400',
                    'Video': 'bg-purple-500/20 text-purple-400'
                };
                const typeColor = typeColors[step.type] || 'bg-gray-500/20 text-gray-400';
                return `
                    <div class="p-4 flex items-center gap-4 hover:bg-dark-700">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center font-bold text-sm flex-shrink-0">
                            ${i + 1}
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="font-medium text-sm truncate">${step.title}</div>
                            <div class="text-xs text-gray-500">${step.description.substring(0, 50)}${step.description.length > 50 ? '...' : ''}</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="status-badge ${typeColor}">${step.type}</span>
                            <span class="text-xs text-gray-500">J+${step.delay}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // =====================
        // REVENUE SECTION
        // =====================

        let revenueData = [];

        async function loadRevenue() {
            const container = document.getElementById('revenue-transactions');
            if (!container) return;
            container.innerHTML = '<div class="p-4 text-center text-gray-500">Chargement...</div>';

            const result = await airtableFetch(CONFIG.tables.revenue);
            if (result && result.records) {
                revenueData = result.records.map(r => ({
                    id: r.id,
                    date: r.fields['Date'] || '',
                    source: r.fields['Source'] || 'Autre',
                    montant: r.fields['Montant'] || 0,
                    client: r.fields['Client'] || '-',
                    description: r.fields['Description'] || '',
                    status: r.fields['Status'] || 'Pending',
                    mois: r.fields['Mois'] || ''
                })).sort((a, b) => new Date(b.date) - new Date(a.date));
                renderRevenue();
            } else {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune transaction</div>';
            }
        }

        function renderRevenue() {
            const container = document.getElementById('revenue-transactions');
            if (!container) return;

            // Calculate totals for current month
            const now = new Date();
            const currentMonth = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
            const monthData = revenueData.filter(r => r.date && r.date.startsWith(currentMonth) && r.status === 'Received');

            const totalMonth = monthData.reduce((sum, r) => sum + (r.montant || 0), 0);
            const affiliations = monthData.filter(r => r.source === 'Affiliation Broker').reduce((sum, r) => sum + (r.montant || 0), 0);
            const formations = monthData.filter(r => r.source === 'Formation HVC').reduce((sum, r) => sum + (r.montant || 0), 0);
            const copytrade = monthData.filter(r => r.source === 'Copytrade PAMM').reduce((sum, r) => sum + (r.montant || 0), 0);

            // Update stats
            const totalEl = document.getElementById('revenue-total');
            const affEl = document.getElementById('revenue-affiliations');
            const formEl = document.getElementById('revenue-formations');
            const copyEl = document.getElementById('revenue-copytrade');
            if (totalEl) totalEl.textContent = totalMonth.toLocaleString('fr-FR') + '€';
            if (affEl) affEl.textContent = affiliations.toLocaleString('fr-FR') + '€';
            if (formEl) formEl.textContent = formations.toLocaleString('fr-FR') + '€';
            if (copyEl) copyEl.textContent = copytrade.toLocaleString('fr-FR') + '€';

            if (revenueData.length === 0) {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune transaction enregistree</div>';
                return;
            }

            const sourceColors = {
                'Affiliation Broker': 'bg-blue-500/20 text-blue-400',
                'Formation HVC': 'bg-purple-500/20 text-purple-400',
                'Copytrade PAMM': 'bg-cyan-500/20 text-cyan-400',
                'Consulting': 'bg-green-500/20 text-green-400',
                'Autre': 'bg-gray-500/20 text-gray-400'
            };

            container.innerHTML = revenueData.slice(0, 20).map(r => {
                const statusColor = r.status === 'Received' ? 'text-green-400' : r.status === 'Cancelled' ? 'text-red-400' : 'text-yellow-400';
                const sourceColor = sourceColors[r.source] || sourceColors['Autre'];
                return `
                    <div class="p-4 flex items-center justify-between hover:bg-dark-700">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-lg ${sourceColor.split(' ')[0]} flex items-center justify-center">
                                <span class="${sourceColor.split(' ')[1]}">€</span>
                            </div>
                            <div>
                                <div class="font-medium text-sm">${r.client || r.source}</div>
                                <div class="text-xs text-gray-500">${r.date || '-'}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold ${statusColor}">${r.montant?.toLocaleString('fr-FR') || 0}€</div>
                            <span class="status-badge ${sourceColor}">${r.source}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // =====================
        // MEMBERS SECTION
        // =====================

        let membersData = [];

        async function loadMembers() {
            const container = document.getElementById('members-table');
            if (!container) return;
            container.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">Chargement...</td></tr>';

            const result = await airtableFetch(CONFIG.tables.members);
            if (result && result.records) {
                membersData = result.records.map(r => ({
                    id: r.id,
                    name: r.fields['Name'] || 'Anonyme',
                    email: r.fields['Email'] || '-',
                    dateInscription: r.fields['Date_Inscription'] || '',
                    lastActivity: r.fields['Last_Activity'] || '',
                    status: r.fields['Status'] || 'Active',
                    plan: r.fields['Plan'] || '-',
                    source: r.fields['Source'] || '-'
                })).sort((a, b) => new Date(b.dateInscription) - new Date(a.dateInscription));
                renderMembers();
            } else {
                container.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">Aucun membre</td></tr>';
            }
        }

        function renderMembers() {
            const container = document.getElementById('members-table');
            if (!container) return;

            const filter = document.getElementById('members-filter-status')?.value || 'all';

            // Calculate stats
            const now = new Date();
            const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);

            const activeMembers = membersData.filter(m => m.lastActivity && new Date(m.lastActivity) >= thirtyDaysAgo);
            const newMembers = membersData.filter(m => m.dateInscription && new Date(m.dateInscription) >= sevenDaysAgo);
            const churnedMembers = membersData.filter(m => m.status === 'Churned');

            // Update stats
            const totalEl = document.getElementById('members-total');
            const activeEl = document.getElementById('members-active');
            const newEl = document.getElementById('members-new');
            const churnEl = document.getElementById('members-churn');
            if (totalEl) totalEl.textContent = membersData.length;
            if (activeEl) activeEl.textContent = activeMembers.length;
            if (newEl) newEl.textContent = newMembers.length;
            if (churnEl) churnEl.textContent = churnedMembers.length;

            let filtered = membersData;
            if (filter === 'active') filtered = activeMembers;
            else if (filter === 'inactive') filtered = membersData.filter(m => !m.lastActivity || new Date(m.lastActivity) < thirtyDaysAgo);
            else if (filter === 'new') filtered = newMembers;

            if (filtered.length === 0) {
                container.innerHTML = '<tr><td colspan="5" class="p-4 text-center text-gray-500">Aucun membre</td></tr>';
                return;
            }

            const statusColors = {
                'Active': 'bg-green-500/20 text-green-400',
                'Inactive': 'bg-gray-500/20 text-gray-400',
                'Churned': 'bg-red-500/20 text-red-400',
                'New': 'bg-blue-500/20 text-blue-400'
            };

            container.innerHTML = filtered.map(m => {
                const statusColor = statusColors[m.status] || statusColors['Active'];
                return `
                    <tr class="hover:bg-dark-700">
                        <td class="px-4 py-3">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-xs font-bold">
                                    ${m.name.substring(0, 2).toUpperCase()}
                                </div>
                                <span class="font-medium">${m.name}</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-sm text-gray-400">${m.email}</td>
                        <td class="px-4 py-3 text-center text-sm">${m.dateInscription || '-'}</td>
                        <td class="px-4 py-3 text-center text-sm">${m.lastActivity || '-'}</td>
                        <td class="px-4 py-3 text-center"><span class="status-badge ${statusColor}">${m.status}</span></td>
                    </tr>
                `;
            }).join('');
        }

        // =====================
        // NEWSLETTER SECTION
        // =====================

        let newsletterData = [];

        async function loadNewsletter() {
            const container = document.getElementById('newsletter-recent-list');
            if (!container) return;
            container.innerHTML = '<div class="p-4 text-center text-gray-500">Chargement...</div>';

            const result = await airtableFetch(CONFIG.tables.newsletter);
            if (result && result.records) {
                newsletterData = result.records.map(r => ({
                    id: r.id,
                    name: r.fields['Campaign_Name'] || '-',
                    dateSent: r.fields['Date_Sent'] || '',
                    type: r.fields['Type'] || 'Newsletter',
                    sent: r.fields['Sent'] || 0,
                    delivered: r.fields['Delivered'] || 0,
                    opened: r.fields['Opened'] || 0,
                    clicked: r.fields['Clicked'] || 0,
                    unsubscribed: r.fields['Unsubscribed'] || 0,
                    openRate: r.fields['Open_Rate'] || 0,
                    clickRate: r.fields['Click_Rate'] || 0
                })).sort((a, b) => new Date(b.dateSent) - new Date(a.dateSent));
                renderNewsletter();
            } else {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune campagne</div>';
            }
        }

        function renderNewsletter() {
            const container = document.getElementById('newsletter-recent-list');
            if (!container) return;

            // Calculate totals
            const totalSent = newsletterData.reduce((sum, n) => sum + (n.sent || 0), 0);
            const totalOpened = newsletterData.reduce((sum, n) => sum + (n.opened || 0), 0);
            const totalClicked = newsletterData.reduce((sum, n) => sum + (n.clicked || 0), 0);
            const totalUnsub = newsletterData.reduce((sum, n) => sum + (n.unsubscribed || 0), 0);

            const avgOpenRate = totalSent > 0 ? ((totalOpened / totalSent) * 100).toFixed(1) : 0;
            const avgClickRate = totalSent > 0 ? ((totalClicked / totalSent) * 100).toFixed(1) : 0;
            const avgUnsubRate = totalSent > 0 ? ((totalUnsub / totalSent) * 100).toFixed(2) : 0;

            // Update stats
            const sentEl = document.getElementById('newsletter-total-sent');
            const openEl = document.getElementById('newsletter-open-rate');
            const clickEl = document.getElementById('newsletter-click-rate');
            const unsubEl = document.getElementById('newsletter-unsub-rate');
            if (sentEl) sentEl.textContent = totalSent.toLocaleString();
            if (openEl) openEl.textContent = avgOpenRate + '%';
            if (clickEl) clickEl.textContent = avgClickRate + '%';
            if (unsubEl) unsubEl.textContent = avgUnsubRate + '%';

            if (newsletterData.length === 0) {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">Aucune campagne - Sync Brevo requis</div>';
                return;
            }

            const typeColors = {
                'Newsletter': 'bg-blue-500/20 text-blue-400',
                'Onboarding': 'bg-purple-500/20 text-purple-400',
                'Promo': 'bg-green-500/20 text-green-400',
                'Automation': 'bg-cyan-500/20 text-cyan-400'
            };

            container.innerHTML = newsletterData.slice(0, 10).map(n => {
                const typeColor = typeColors[n.type] || typeColors['Newsletter'];
                return `
                    <div class="p-4 flex items-center justify-between hover:bg-dark-700">
                        <div class="flex-1">
                            <div class="font-medium text-sm">${n.name}</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="status-badge ${typeColor}">${n.type}</span>
                                <span class="text-xs text-gray-500">${n.dateSent || '-'}</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-medium">${n.sent}</div>
                                <div class="text-xs text-gray-500">Envoyés</div>
                            </div>
                            <div class="text-center">
                                <div class="font-medium text-green-400">${(n.openRate * 100).toFixed(1)}%</div>
                                <div class="text-xs text-gray-500">Ouverture</div>
                            </div>
                            <div class="text-center">
                                <div class="font-medium text-blue-400">${(n.clickRate * 100).toFixed(1)}%</div>
                                <div class="text-xs text-gray-500">Clics</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Update onboarding stats
            const onboardingStats = document.getElementById('newsletter-onboarding-stats');
            if (onboardingStats) {
                const onboardingCampaigns = newsletterData.filter(n => n.type === 'Onboarding');
                if (onboardingCampaigns.length > 0) {
                    const avgOnboardingOpen = onboardingCampaigns.reduce((sum, n) => sum + n.openRate, 0) / onboardingCampaigns.length;
                    onboardingStats.innerHTML = `
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-400">Emails onboarding</span>
                                <span class="font-medium">${onboardingCampaigns.length}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-400">Taux ouverture moyen</span>
                                <span class="font-medium text-green-400">${(avgOnboardingOpen * 100).toFixed(1)}%</span>
                            </div>
                        </div>
                    `;
                } else {
                    onboardingStats.innerHTML = '<div class="text-center text-gray-500">Aucune campagne onboarding</div>';
                }
            }
        }

        // =====================
        // ILIA CHATBOT
        // =====================

        let iliaChatOpen = false;
        let iliaChatHistory = [];

        function toggleIliaChat() {
            const chatWindow = document.getElementById('ilia-chat-window');
            if (!chatWindow) return;

            iliaChatOpen = !iliaChatOpen;

            if (iliaChatOpen) {
                chatWindow.classList.remove('hidden');
                document.getElementById('ilia-input')?.focus();
            } else {
                chatWindow.classList.add('hidden');
            }
        }

        async function sendIliaMessage() {
            const input = document.getElementById('ilia-input');
            if (!input) return;
            const message = input.value.trim();
            if (!message) return;

            const messagesContainer = document.getElementById('ilia-messages');
            if (!messagesContainer) return;

            // Add user message
            messagesContainer.innerHTML += `
                <div class="flex justify-end gap-2">
                    <div class="bg-blue-600 rounded-lg rounded-tr-none p-3 max-w-[80%]">
                        <p class="text-sm">${message}</p>
                    </div>
                </div>
            `;
            input.value = '';

            // Add loading indicator
            const loadingId = 'loading-' + Date.now();
            messagesContainer.innerHTML += `
                <div id="${loadingId}" class="flex gap-2">
                    <div class="w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0">
                        <span>🤖</span>
                    </div>
                    <div class="bg-dark-700 rounded-lg rounded-tl-none p-3">
                        <p class="text-sm text-gray-400">ILIA reflechit...</p>
                    </div>
                </div>
            `;
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            try {
                const response = await fetch('https://n8n.srv1140766.hstgr.cloud/webhook/ilia-chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message, history: iliaChatHistory })
                });

                const data = await response.json();
                const reply = data.response || data.message || 'Desole, je n\'ai pas pu repondre.';

                // Remove loading and add response
                document.getElementById(loadingId)?.remove();
                messagesContainer.innerHTML += `
                    <div class="flex gap-2">
                        <div class="w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0">
                            <span>🤖</span>
                        </div>
                        <div class="bg-dark-700 rounded-lg rounded-tl-none p-3 max-w-[80%]">
                            <p class="text-sm">${reply}</p>
                        </div>
                    </div>
                `;

                iliaChatHistory.push({ role: 'user', content: message });
                iliaChatHistory.push({ role: 'assistant', content: reply });

            } catch (error) {
                document.getElementById(loadingId)?.remove();
                messagesContainer.innerHTML += `
                    <div class="flex gap-2">
                        <div class="w-8 h-8 bg-red-500/20 rounded-full flex items-center justify-center flex-shrink-0">
                            <span>⚠️</span>
                        </div>
                        <div class="bg-red-500/10 rounded-lg rounded-tl-none p-3">
                            <p class="text-sm text-red-300">Erreur de connexion a ILIA</p>
                        </div>
                    </div>
                `;
            }

            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
    </script>
</body>
</html>
